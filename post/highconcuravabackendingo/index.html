<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/css/283bb1ed86b49fd2.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/09ec4099fb721b31.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/09dfadb69bdaa005.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/54b9acc791aa599c.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-ede82f7d0ae11dac.js"/><script src="/_next/static/chunks/4bd1b696-299743f5624cdabe.js" async=""></script><script src="/_next/static/chunks/684-481501000630d05e.js" async=""></script><script src="/_next/static/chunks/main-app-eb9456c5a3bb7ef4.js" async=""></script><script src="/_next/static/chunks/766-f505dbd3efffaa4c.js" async=""></script><script src="/_next/static/chunks/226-13d4d3f1fc18ceb6.js" async=""></script><script src="/_next/static/chunks/app/layout-b3ce58a25da6999d.js" async=""></script><script src="/_next/static/chunks/874-e909718850e7282e.js" async=""></script><script src="/_next/static/chunks/734-02ba314a893e68e9.js" async=""></script><script src="/_next/static/chunks/351-1a0463ef6ec6e59e.js" async=""></script><script src="/_next/static/chunks/app/post/%5Bid%5D/page-871a46f82159f9c4.js" async=""></script><title>聊聊高并发高可用云服务设计（Go语言版）</title><meta name="description" content="HCHEN90 博客"/><link rel="alternate" type="application/atom+xml" href="https://hchen90.top/atom.xml"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="16x16"/><script>document.querySelectorAll('body link[rel="icon"], body link[rel="apple-touch-icon"]').forEach(el => document.head.appendChild(el))</script><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="antialiased relative"><div class="fixed top-4 right-4 z-50"><a href="https://github.com/hchen90" target="_blank" rel="noopener noreferrer" class="flex items-center justify-center p-2 bg-white rounded-full shadow-md hover:shadow-lg transition-shadow duration-300" title="Visit my GitHub profile"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path></svg></a></div><div class="min-h-screen relative"><div class="fixed top-0 left-0 h-1 bg-blue-500 z-50 transition-all duration-300" style="width:0%"></div><button class="fixed bottom-24 right-8 p-3 rounded-full bg-blue-600 hover:bg-blue-700 text-white shadow-lg transition-opacity duration-300 z-50 opacity-0 pointer-events-none" aria-label="Back to top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 19V5M5 12l7-7 7 7"></path></svg></button><div class="main-content transition-all duration-300"><div class="max-w-4xl mx-auto px-4 py-8"><div class="mb-8"><a class="text-blue-500 hover:underline mb-4 inline-block" href="/">← 返回首页</a></div><article><header class="mb-8"><h1 class="text-4xl font-bold mb-4">聊聊高并发高可用云服务设计（Go语言版）</h1><div class="text-gray-500 mb-4">2025年10月26日</div></header><div class="markdown-content"><h1 id="聊聊高并发高可用云服务设计go语言版">聊聊高并发高可用云服务设计（Go语言版）<a aria-hidden="true" tabindex="-1" href="#聊聊高并发高可用云服务设计go语言版"><span class="anchor-link"> #</span></a></h1>
<p>本文以 Go 语言云服务为例，系统性介绍如何设计、实现、测试一个高并发、高可用的生产级后 端系统。文章不仅覆盖架构设计思想，也结合常见中间件（Kafka / Redis / Postgres / etcd / Kubernetes 等）给出工程实践建议。</p>
<h2 id="一什么是高并发high-concurrency">一、什么是高并发（High Concurrency）<a aria-hidden="true" tabindex="-1" href="#一什么是高并发high-concurrency"><span class="anchor-link"> #</span></a></h2>
<p><strong>高并发</strong>指系统在单位时间内能够同时处理大量请求的能力。</p>
<p>常见衡量指标：</p>
<ul>
<li><strong>QPS / TPS</strong>：每秒请求数 / 事务数</li>
<li><strong>并发连接数</strong>：同时在线请求数</li>
<li><strong>响应时间（Latency）</strong>：P95 / P99</li>
<li><strong>吞吐量（Throughput）</strong></li>
</ul>
<p>高并发的本质问题不是“快”，而是：</p>
<blockquote>
<p><strong>在资源有限的情况下，如何高效调度 CPU、内存、IO、网络</strong>。</p>
</blockquote>
<h3 id="go-语言天然适合高并发">Go 语言天然适合高并发<a aria-hidden="true" tabindex="-1" href="#go-语言天然适合高并发"><span class="anchor-link"> #</span></a></h3>
<ul>
<li>goroutine：极低成本的并发模型</li>
<li>channel：安全的并发通信</li>
<li>调度器（GMP 模型）：避免线程爆炸</li>
<li>丰富的网络库（net/http, grpc）</li>
</ul>
<h2 id="二什么是高可用high-availability">二、什么是高可用（High Availability）<a aria-hidden="true" tabindex="-1" href="#二什么是高可用high-availability"><span class="anchor-link"> #</span></a></h2>
<p><strong>高可用</strong>关注的是：</p>
<blockquote>
<p><strong>系统在故障发生时，是否仍然可以对外提供服务</strong>。</p>
</blockquote>
<p>常见指标：</p>
<ul>
<li><strong>可用性 SLA</strong>：99.9% / 99.99%</li>
<li><strong>MTBF / MTTR</strong>：平均无故障时间 / 故障恢复时间</li>
</ul>
<p>高可用关注的是：</p>
<ul>
<li>故障隔离</li>
<li>自动恢复</li>
<li>降级与兜底</li>
</ul>
<p>一句话总结：</p>
<blockquote>
<p><strong>高并发解决的是“忙不忙”，高可用解决的是“挂不挂”</strong>。</p>
</blockquote>
<h2 id="三如何做到高并发">三、如何做到高并发<a aria-hidden="true" tabindex="-1" href="#三如何做到高并发"><span class="anchor-link"> #</span></a></h2>
<h3 id="1-异步化设计核心思想">1. 异步化设计（核心思想）<a aria-hidden="true" tabindex="-1" href="#1-异步化设计核心思想"><span class="anchor-link"> #</span></a></h3>
<p>同步调用：</p>
<p><img src="/post/highconcuravabackendingo/2099ac4a68ef.png" alt="sync call"></p>
<p>异步化：</p>
<p><img src="/post/highconcuravabackendingo/0c96b15de337.png" alt="async call"></p>
<p>适合异步的场景：</p>
<ul>
<li>下单后发通知</li>
<li>写日志 / 行为埋点</li>
<li>账务对账</li>
<li>数据同步</li>
</ul>
<h3 id="2-消息队列kafka--rocketmq">2. 消息队列：Kafka / RocketMQ<a aria-hidden="true" tabindex="-1" href="#2-消息队列kafka--rocketmq"><span class="anchor-link"> #</span></a></h3>
<p><strong>作用</strong>：</p>
<ul>
<li>削峰填谷</li>
<li>解耦服务</li>
<li>异步处理</li>
</ul>
<p>对比：</p>
<table>
<thead>
<tr>
<th>对比项</th>
<th>Kafka</th>
<th>RocketMQ</th>
</tr>
</thead>
<tbody>
<tr>
<td>吞吐</td>
<td>极高</td>
<td>高</td>
</tr>
<tr>
<td>顺序</td>
<td>分区有序</td>
<td>严格顺序</td>
</tr>
<tr>
<td>事务</td>
<td>弱</td>
<td>强</td>
</tr>
<tr>
<td>运维</td>
<td>偏复杂</td>
<td>相对友好</td>
</tr>
</tbody>
</table>
<p>Go 中常用：</p>
<ul>
<li>sarama（Kafka）</li>
<li>rocketmq-client-go</li>
</ul>
<h3 id="3-redis高并发缓存核心">3. Redis：高并发缓存核心<a aria-hidden="true" tabindex="-1" href="#3-redis高并发缓存核心"><span class="anchor-link"> #</span></a></h3>
<h4 id="31-过期策略">3.1 过期策略<a aria-hidden="true" tabindex="-1" href="#31-过期策略"><span class="anchor-link"> #</span></a></h4>
<ul>
<li>定期删除</li>
<li>惰性删除</li>
</ul>
<h4 id="32-淘汰策略">3.2 淘汰策略<a aria-hidden="true" tabindex="-1" href="#32-淘汰策略"><span class="anchor-link"> #</span></a></h4>
<ul>
<li>volatile-lru</li>
<li>allkeys-lru（推荐）</li>
<li>volatile-ttl</li>
</ul>
<h4 id="33-sentinel-vs-cluster">3.3 Sentinel vs Cluster<a aria-hidden="true" tabindex="-1" href="#33-sentinel-vs-cluster"><span class="anchor-link"> #</span></a></h4>
<table>
<thead>
<tr>
<th>模式</th>
<th>适用场景</th>
<th>特点</th>
</tr>
</thead>
<tbody>
<tr>
<td>Sentinel</td>
<td>高可用</td>
<td>自动主从切换</td>
</tr>
<tr>
<td>Cluster</td>
<td>高并发 + 大数据</td>
<td>分片、扩展性强</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>读多写少 + 高并发场景：Redis Cluster 是标配</strong>。</p>
</blockquote>
<h3 id="4-数据库postgres-高并发设计">4. 数据库：Postgres 高并发设计<a aria-hidden="true" tabindex="-1" href="#4-数据库postgres-高并发设计"><span class="anchor-link"> #</span></a></h3>
<h4 id="41-索引设计">4.1 索引设计<a aria-hidden="true" tabindex="-1" href="#41-索引设计"><span class="anchor-link"> #</span></a></h4>
<ul>
<li>B-Tree（默认）</li>
<li>覆盖索引</li>
<li>避免隐式类型转换</li>
</ul>
<h4 id="42-分表--分区">4.2 分表 / 分区<a aria-hidden="true" tabindex="-1" href="#42-分表--分区"><span class="anchor-link"> #</span></a></h4>
<ul>
<li>按时间分区（日志、订单）</li>
<li>按业务维度分表</li>
</ul>
<p>Postgres 原生支持 <strong>Partition Table</strong>，优于手工分表。</p>
<h4 id="43-gorm-使用建议">4.3 GORM 使用建议<a aria-hidden="true" tabindex="-1" href="#43-gorm-使用建议"><span class="anchor-link"> #</span></a></h4>
<ul>
<li>禁止全表扫描</li>
<li>显式 Select 字段</li>
<li>使用 Prepared Statement</li>
<li>控制连接池</li>
</ul>
<h3 id="5-单体-vs-微服务并发视角">5. 单体 vs 微服务（并发视角）<a aria-hidden="true" tabindex="-1" href="#5-单体-vs-微服务并发视角"><span class="anchor-link"> #</span></a></h3>
<table>
<thead>
<tr>
<th>架构</th>
<th>优点</th>
<th>缺点</th>
</tr>
</thead>
<tbody>
<tr>
<td>单体</td>
<td>简单、性能好</td>
<td>难扩展</td>
</tr>
<tr>
<td>微服务</td>
<td>易扩展、隔离</td>
<td>网络开销、复杂</td>
</tr>
</tbody>
</table>
<p>高并发系统<strong>不一定要微服务</strong>，但必须：</p>
<ul>
<li>模块解耦</li>
<li>接口清晰</li>
</ul>
<h2 id="四如何做到高可用">四、如何做到高可用<a aria-hidden="true" tabindex="-1" href="#四如何做到高可用"><span class="anchor-link"> #</span></a></h2>
<h3 id="1-多副本与负载均衡">1. 多副本与负载均衡<a aria-hidden="true" tabindex="-1" href="#1-多副本与负载均衡"><span class="anchor-link"> #</span></a></h3>
<h4 id="负载均衡方案对比">负载均衡方案对比<a aria-hidden="true" tabindex="-1" href="#负载均衡方案对比"><span class="anchor-link"> #</span></a></h4>
<table>
<thead>
<tr>
<th>方案</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>NGINX</td>
<td>成熟、灵活</td>
</tr>
<tr>
<td>AWS ALB/NLB</td>
<td>托管、稳定</td>
</tr>
<tr>
<td>K8s Service</td>
<td>原生、自动</td>
</tr>
<tr>
<td>Docker Replica</td>
<td>基础扩展</td>
</tr>
</tbody>
</table>
<h3 id="2-etcd配置与服务发现">2. etcd：配置与服务发现<a aria-hidden="true" tabindex="-1" href="#2-etcd配置与服务发现"><span class="anchor-link"> #</span></a></h3>
<ul>
<li>强一致性（Raft）</li>
<li>配置中心</li>
<li>服务注册发现</li>
</ul>
<p>常见用途：</p>
<ul>
<li>动态配置</li>
<li>分布式锁</li>
<li>Leader 选举</li>
</ul>
<h3 id="3-微服务设计ddd--grpc">3. 微服务设计（DDD + gRPC）<a aria-hidden="true" tabindex="-1" href="#3-微服务设计ddd--grpc"><span class="anchor-link"> #</span></a></h3>
<h4 id="ddd-核心思想">DDD 核心思想<a aria-hidden="true" tabindex="-1" href="#ddd-核心思想"><span class="anchor-link"> #</span></a></h4>
<ul>
<li>Bounded Context</li>
<li>聚合根</li>
<li>领域事件</li>
</ul>
<h4 id="grpc--go-micro-的优势">gRPC + go-micro 的优势<a aria-hidden="true" tabindex="-1" href="#grpc--go-micro-的优势"><span class="anchor-link"> #</span></a></h4>
<ul>
<li>高性能</li>
<li>内建服务发现</li>
<li>中间件生态完善</li>
</ul>
<h2 id="五可观测性系统不透明等于不可用">五、可观测性：系统不透明等于不可用<a aria-hidden="true" tabindex="-1" href="#五可观测性系统不透明等于不可用"><span class="anchor-link"> #</span></a></h2>
<h3 id="1-日志采集">1. 日志采集<a aria-hidden="true" tabindex="-1" href="#1-日志采集"><span class="anchor-link"> #</span></a></h3>
<ul>
<li>Grafana Loki（轻量）</li>
<li>Graylog（全文检索）</li>
</ul>
<h3 id="2-trace">2. Trace<a aria-hidden="true" tabindex="-1" href="#2-trace"><span class="anchor-link"> #</span></a></h3>
<ul>
<li>Jaeger</li>
<li>OpenTelemetry</li>
</ul>
<h3 id="3-指标监控">3. 指标监控<a aria-hidden="true" tabindex="-1" href="#3-指标监控"><span class="anchor-link"> #</span></a></h3>
<ul>
<li>Prometheus</li>
<li>Grafana Dashboard</li>
</ul>
<p>核心指标：</p>
<ul>
<li>QPS</li>
<li>Error Rate</li>
<li>P99 Latency</li>
<li>CPU / Memory</li>
</ul>
<h3 id="4-异常监控与健康检查">4. 异常监控与健康检查<a aria-hidden="true" tabindex="-1" href="#4-异常监控与健康检查"><span class="anchor-link"> #</span></a></h3>
<ul>
<li>Grafana AlertManager</li>
<li>UptimeRobot</li>
<li>Kubernetes Liveness / Readiness Probe</li>
</ul>
<h2 id="六如何测试高并发">六、如何测试高并发<a aria-hidden="true" tabindex="-1" href="#六如何测试高并发"><span class="anchor-link"> #</span></a></h2>
<h3 id="1-压测工具">1. 压测工具<a aria-hidden="true" tabindex="-1" href="#1-压测工具"><span class="anchor-link"> #</span></a></h3>
<ul>
<li>wrk</li>
<li>hey</li>
<li>k6</li>
</ul>
<h3 id="2-压测原则">2. 压测原则<a aria-hidden="true" tabindex="-1" href="#2-压测原则"><span class="anchor-link"> #</span></a></h3>
<ul>
<li>逐步加压</li>
<li>找到瓶颈</li>
<li>验证缓存命中率</li>
</ul>
<h3 id="3-常见瓶颈">3. 常见瓶颈<a aria-hidden="true" tabindex="-1" href="#3-常见瓶颈"><span class="anchor-link"> #</span></a></h3>
<ul>
<li>数据库连接池</li>
<li>锁竞争</li>
<li>GC</li>
<li>网络 IO</li>
</ul>
<h2 id="七如何测试高可用">七、如何测试高可用<a aria-hidden="true" tabindex="-1" href="#七如何测试高可用"><span class="anchor-link"> #</span></a></h2>
<h3 id="故障演练chaos-engineering">故障演练（Chaos Engineering）<a aria-hidden="true" tabindex="-1" href="#故障演练chaos-engineering"><span class="anchor-link"> #</span></a></h3>
<ul>
<li>杀 Pod</li>
<li>网络延迟</li>
<li>Redis / DB 宕机</li>
</ul>
<p>工具：</p>
<ul>
<li>Chaos Mesh</li>
<li>手动演练</li>
</ul>
<h2 id="八风险兜底服务挂了怎么办">八、风险兜底：服务挂了怎么办？<a aria-hidden="true" tabindex="-1" href="#八风险兜底服务挂了怎么办"><span class="anchor-link"> #</span></a></h2>
<h3 id="1-降级">1. 降级<a aria-hidden="true" tabindex="-1" href="#1-降级"><span class="anchor-link"> #</span></a></h3>
<ul>
<li>关闭非核心功能</li>
<li>返回兜底数据</li>
</ul>
<h3 id="2-限流">2. 限流<a aria-hidden="true" tabindex="-1" href="#2-限流"><span class="anchor-link"> #</span></a></h3>
<ul>
<li>Token Bucket</li>
<li>Leaky Bucket</li>
<li>Redis / Envoy / NGINX</li>
</ul>
<h3 id="3-熔断">3. 熔断<a aria-hidden="true" tabindex="-1" href="#3-熔断"><span class="anchor-link"> #</span></a></h3>
<ul>
<li>错误率触发</li>
<li>自动恢复</li>
</ul>
<h3 id="4-灾备">4. 灾备<a aria-hidden="true" tabindex="-1" href="#4-灾备"><span class="anchor-link"> #</span></a></h3>
<ul>
<li>多可用区部署</li>
<li>数据备份</li>
<li>冷热切换</li>
</ul>
<h2 id="九总结">九、总结<a aria-hidden="true" tabindex="-1" href="#九总结"><span class="anchor-link"> #</span></a></h2>
<p>一个真正的<strong>高并发、高可用 Go 云服务</strong>不是靠某一个中间件堆出来的，而是：</p>
<blockquote>
<p><strong>架构设计 + 工程规范 + 自动化运维 + 故障意识</strong> 的综合结果。</p>
</blockquote>
<p>如果你只能记住一句话：</p>
<blockquote>
<p><strong>先保证不挂，再追求更快。</strong></p>
</blockquote></div><div class="mt-12 pt-6 border-t border-gray-200 dark:border-gray-700"><a class="text-blue-500 hover:underline" href="/">← 返回所有文章列表</a></div><div class="mt-8 pt-4 border-t border-gray-200 dark:border-gray-700 text-center text-gray-500 text-sm">© 2013 – 2025 陈祥</div></article></div></div></div><!--$--><!--/$--><!--$--><!--/$--><script src="/_next/static/chunks/webpack-ede82f7d0ae11dac.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[7555,[],\"\"]\n3:I[1295,[],\"\"]\n4:I[415,[\"766\",\"static/chunks/766-f505dbd3efffaa4c.js\",\"226\",\"static/chunks/226-13d4d3f1fc18ceb6.js\",\"177\",\"static/chunks/app/layout-b3ce58a25da6999d.js\"],\"default\"]\n5:I[9243,[\"766\",\"static/chunks/766-f505dbd3efffaa4c.js\",\"226\",\"static/chunks/226-13d4d3f1fc18ceb6.js\",\"177\",\"static/chunks/app/layout-b3ce58a25da6999d.js\"],\"\"]\n8:I[9665,[],\"MetadataBoundary\"]\na:I[9665,[],\"OutletBoundary\"]\nd:I[4911,[],\"AsyncMetadataOutlet\"]\nf:I[9665,[],\"ViewportBoundary\"]\n11:I[6614,[],\"\"]\n:HL[\"/_next/static/css/283bb1ed86b49fd2.css\",\"style\"]\n:HL[\"/_next/static/css/09ec4099fb721b31.css\",\"style\"]\n:HL[\"/_next/static/css/09dfadb69bdaa005.css\",\"style\"]\n:HL[\"/_next/static/css/54b9acc791aa599c.css\",\"style\"]\n6:T4a2,\n          function copyCode(button) {\n            // Find the code element within the same wrapper\n            const codeWrapper = button.closest('.code-block-wrapper');\n            if (!codeWrapper) return;\n            \n            const codeElement = codeWrapper.querySelector('code');\n            if (!codeElement) return;\n            \n            // Get the text content\n            const text = codeElement.textContent;\n            \n            // Use the clipboard API to copy the text\n            navigator.clipboard.writeText(text).then(() =\u003e {\n              // Update the button state to show \"Copied!\"\n              button.setAttribute('data-copy-state', 'copied');\n              const buttonText = button.querySelector('.copy-button-text');\n              if (buttonText) buttonText.textContent = 'Copied!';\n              \n              // Reset after 2 seconds\n              setTimeout(() =\u003e {\n                button.setAttribute('data-copy-state', 'copy');\n                if (buttonText) buttonText.textContent = 'Copy';\n              }, 2000);\n            }).catch(err =\u003e {\n              console.error('Failed to copy text: ', err);\n            });\n          }\n          "])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"xsQ5PUF4c2cJqxppneo-C\",\"p\":\"\",\"c\":[\"\",\"post\",\"highconcuravabackendingo\",\"\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"post\",{\"children\":[[\"id\",\"highconcuravabackendingo\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/283bb1ed86b49fd2.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/09ec4099fb721b31.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"2\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/09dfadb69bdaa005.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"className\":\"antialiased relative\",\"children\":[[\"$\",\"div\",null,{\"className\":\"fixed top-4 right-4 z-50\",\"children\":[\"$\",\"a\",null,{\"href\":\"https://github.com/hchen90\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"className\":\"flex items-center justify-center p-2 bg-white rounded-full shadow-md hover:shadow-lg transition-shadow duration-300\",\"title\":\"Visit my GitHub profile\",\"children\":[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":\"24\",\"height\":\"24\",\"viewBox\":\"0 0 24 24\",\"fill\":\"currentColor\",\"children\":[\"$\",\"path\",null,{\"d\":\"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z\"}]}]}]}],[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}],[\"$\",\"$L4\",null,{}],[\"$\",\"$L5\",null,{\"id\":\"code-copy\",\"children\":\"$6\"}]]}]}]]}],{\"children\":[\"post\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"id\",\"highconcuravabackendingo\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L7\",[\"$\",\"$L8\",null,{\"children\":\"$L9\"}],[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/54b9acc791aa599c.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"$La\",null,{\"children\":[\"$Lb\",\"$Lc\",[\"$\",\"$Ld\",null,{\"promise\":\"$@e\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"vRj5XPgCbubJyti_VgSfX\",{\"children\":[[\"$\",\"$Lf\",null,{\"children\":\"$L10\"}],null]}],null]}],false]],\"m\":\"$undefined\",\"G\":[\"$11\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"12:\"$Sreact.suspense\"\n13:I[4911,[],\"AsyncMetadata\"]\n9:[\"$\",\"$12\",null,{\"fallback\":null,\"children\":[\"$\",\"$L13\",null,{\"promise\":\"$@14\"}]}]\n"])</script><script>self.__next_f.push([1,"c:null\n"])</script><script>self.__next_f.push([1,"15:I[9543,[\"874\",\"static/chunks/874-e909718850e7282e.js\",\"734\",\"static/chunks/734-02ba314a893e68e9.js\",\"351\",\"static/chunks/351-1a0463ef6ec6e59e.js\",\"457\",\"static/chunks/app/post/%5Bid%5D/page-871a46f82159f9c4.js\"],\"default\"]\n16:T328c,"])</script><script>self.__next_f.push([1,"\u003ch1 id=\"聊聊高并发高可用云服务设计go语言版\"\u003e聊聊高并发高可用云服务设计（Go语言版）\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#聊聊高并发高可用云服务设计go语言版\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003cp\u003e本文以 Go 语言云服务为例，系统性介绍如何设计、实现、测试一个高并发、高可用的生产级后 端系统。文章不仅覆盖架构设计思想，也结合常见中间件（Kafka / Redis / Postgres / etcd / Kubernetes 等）给出工程实践建议。\u003c/p\u003e\n\u003ch2 id=\"一什么是高并发high-concurrency\"\u003e一、什么是高并发（High Concurrency）\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#一什么是高并发high-concurrency\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003e高并发\u003c/strong\u003e指系统在单位时间内能够同时处理大量请求的能力。\u003c/p\u003e\n\u003cp\u003e常见衡量指标：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eQPS / TPS\u003c/strong\u003e：每秒请求数 / 事务数\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e并发连接数\u003c/strong\u003e：同时在线请求数\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e响应时间（Latency）\u003c/strong\u003e：P95 / P99\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e吞吐量（Throughput）\u003c/strong\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e高并发的本质问题不是“快”，而是：\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003e在资源有限的情况下，如何高效调度 CPU、内存、IO、网络\u003c/strong\u003e。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"go-语言天然适合高并发\"\u003eGo 语言天然适合高并发\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#go-语言天然适合高并发\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003egoroutine：极低成本的并发模型\u003c/li\u003e\n\u003cli\u003echannel：安全的并发通信\u003c/li\u003e\n\u003cli\u003e调度器（GMP 模型）：避免线程爆炸\u003c/li\u003e\n\u003cli\u003e丰富的网络库（net/http, grpc）\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"二什么是高可用high-availability\"\u003e二、什么是高可用（High Availability）\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#二什么是高可用high-availability\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003e高可用\u003c/strong\u003e关注的是：\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003e系统在故障发生时，是否仍然可以对外提供服务\u003c/strong\u003e。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e常见指标：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e可用性 SLA\u003c/strong\u003e：99.9% / 99.99%\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eMTBF / MTTR\u003c/strong\u003e：平均无故障时间 / 故障恢复时间\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e高可用关注的是：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e故障隔离\u003c/li\u003e\n\u003cli\u003e自动恢复\u003c/li\u003e\n\u003cli\u003e降级与兜底\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e一句话总结：\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003e高并发解决的是“忙不忙”，高可用解决的是“挂不挂”\u003c/strong\u003e。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2 id=\"三如何做到高并发\"\u003e三、如何做到高并发\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#三如何做到高并发\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003ch3 id=\"1-异步化设计核心思想\"\u003e1. 异步化设计（核心思想）\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#1-异步化设计核心思想\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e同步调用：\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post/highconcuravabackendingo/2099ac4a68ef.png\" alt=\"sync call\"\u003e\u003c/p\u003e\n\u003cp\u003e异步化：\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post/highconcuravabackendingo/0c96b15de337.png\" alt=\"async call\"\u003e\u003c/p\u003e\n\u003cp\u003e适合异步的场景：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e下单后发通知\u003c/li\u003e\n\u003cli\u003e写日志 / 行为埋点\u003c/li\u003e\n\u003cli\u003e账务对账\u003c/li\u003e\n\u003cli\u003e数据同步\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"2-消息队列kafka--rocketmq\"\u003e2. 消息队列：Kafka / RocketMQ\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#2-消息队列kafka--rocketmq\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003e作用\u003c/strong\u003e：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e削峰填谷\u003c/li\u003e\n\u003cli\u003e解耦服务\u003c/li\u003e\n\u003cli\u003e异步处理\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e对比：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e对比项\u003c/th\u003e\n\u003cth\u003eKafka\u003c/th\u003e\n\u003cth\u003eRocketMQ\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e吞吐\u003c/td\u003e\n\u003ctd\u003e极高\u003c/td\u003e\n\u003ctd\u003e高\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e顺序\u003c/td\u003e\n\u003ctd\u003e分区有序\u003c/td\u003e\n\u003ctd\u003e严格顺序\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e事务\u003c/td\u003e\n\u003ctd\u003e弱\u003c/td\u003e\n\u003ctd\u003e强\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e运维\u003c/td\u003e\n\u003ctd\u003e偏复杂\u003c/td\u003e\n\u003ctd\u003e相对友好\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003eGo 中常用：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003esarama（Kafka）\u003c/li\u003e\n\u003cli\u003erocketmq-client-go\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"3-redis高并发缓存核心\"\u003e3. Redis：高并发缓存核心\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#3-redis高并发缓存核心\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003ch4 id=\"31-过期策略\"\u003e3.1 过期策略\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#31-过期策略\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e定期删除\u003c/li\u003e\n\u003cli\u003e惰性删除\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"32-淘汰策略\"\u003e3.2 淘汰策略\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#32-淘汰策略\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003evolatile-lru\u003c/li\u003e\n\u003cli\u003eallkeys-lru（推荐）\u003c/li\u003e\n\u003cli\u003evolatile-ttl\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"33-sentinel-vs-cluster\"\u003e3.3 Sentinel vs Cluster\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#33-sentinel-vs-cluster\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e模式\u003c/th\u003e\n\u003cth\u003e适用场景\u003c/th\u003e\n\u003cth\u003e特点\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eSentinel\u003c/td\u003e\n\u003ctd\u003e高可用\u003c/td\u003e\n\u003ctd\u003e自动主从切换\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCluster\u003c/td\u003e\n\u003ctd\u003e高并发 + 大数据\u003c/td\u003e\n\u003ctd\u003e分片、扩展性强\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003e读多写少 + 高并发场景：Redis Cluster 是标配\u003c/strong\u003e。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"4-数据库postgres-高并发设计\"\u003e4. 数据库：Postgres 高并发设计\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#4-数据库postgres-高并发设计\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003ch4 id=\"41-索引设计\"\u003e4.1 索引设计\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#41-索引设计\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eB-Tree（默认）\u003c/li\u003e\n\u003cli\u003e覆盖索引\u003c/li\u003e\n\u003cli\u003e避免隐式类型转换\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"42-分表--分区\"\u003e4.2 分表 / 分区\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#42-分表--分区\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e按时间分区（日志、订单）\u003c/li\u003e\n\u003cli\u003e按业务维度分表\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003ePostgres 原生支持 \u003cstrong\u003ePartition Table\u003c/strong\u003e，优于手工分表。\u003c/p\u003e\n\u003ch4 id=\"43-gorm-使用建议\"\u003e4.3 GORM 使用建议\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#43-gorm-使用建议\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e禁止全表扫描\u003c/li\u003e\n\u003cli\u003e显式 Select 字段\u003c/li\u003e\n\u003cli\u003e使用 Prepared Statement\u003c/li\u003e\n\u003cli\u003e控制连接池\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"5-单体-vs-微服务并发视角\"\u003e5. 单体 vs 微服务（并发视角）\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#5-单体-vs-微服务并发视角\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e架构\u003c/th\u003e\n\u003cth\u003e优点\u003c/th\u003e\n\u003cth\u003e缺点\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e单体\u003c/td\u003e\n\u003ctd\u003e简单、性能好\u003c/td\u003e\n\u003ctd\u003e难扩展\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e微服务\u003c/td\u003e\n\u003ctd\u003e易扩展、隔离\u003c/td\u003e\n\u003ctd\u003e网络开销、复杂\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e高并发系统\u003cstrong\u003e不一定要微服务\u003c/strong\u003e，但必须：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e模块解耦\u003c/li\u003e\n\u003cli\u003e接口清晰\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"四如何做到高可用\"\u003e四、如何做到高可用\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#四如何做到高可用\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003ch3 id=\"1-多副本与负载均衡\"\u003e1. 多副本与负载均衡\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#1-多副本与负载均衡\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003ch4 id=\"负载均衡方案对比\"\u003e负载均衡方案对比\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#负载均衡方案对比\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e方案\u003c/th\u003e\n\u003cth\u003e说明\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eNGINX\u003c/td\u003e\n\u003ctd\u003e成熟、灵活\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eAWS ALB/NLB\u003c/td\u003e\n\u003ctd\u003e托管、稳定\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eK8s Service\u003c/td\u003e\n\u003ctd\u003e原生、自动\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eDocker Replica\u003c/td\u003e\n\u003ctd\u003e基础扩展\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"2-etcd配置与服务发现\"\u003e2. etcd：配置与服务发现\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#2-etcd配置与服务发现\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e强一致性（Raft）\u003c/li\u003e\n\u003cli\u003e配置中心\u003c/li\u003e\n\u003cli\u003e服务注册发现\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e常见用途：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e动态配置\u003c/li\u003e\n\u003cli\u003e分布式锁\u003c/li\u003e\n\u003cli\u003eLeader 选举\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"3-微服务设计ddd--grpc\"\u003e3. 微服务设计（DDD + gRPC）\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#3-微服务设计ddd--grpc\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003ch4 id=\"ddd-核心思想\"\u003eDDD 核心思想\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#ddd-核心思想\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eBounded Context\u003c/li\u003e\n\u003cli\u003e聚合根\u003c/li\u003e\n\u003cli\u003e领域事件\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"grpc--go-micro-的优势\"\u003egRPC + go-micro 的优势\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#grpc--go-micro-的优势\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e高性能\u003c/li\u003e\n\u003cli\u003e内建服务发现\u003c/li\u003e\n\u003cli\u003e中间件生态完善\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"五可观测性系统不透明等于不可用\"\u003e五、可观测性：系统不透明等于不可用\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#五可观测性系统不透明等于不可用\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003ch3 id=\"1-日志采集\"\u003e1. 日志采集\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#1-日志采集\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eGrafana Loki（轻量）\u003c/li\u003e\n\u003cli\u003eGraylog（全文检索）\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"2-trace\"\u003e2. Trace\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#2-trace\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eJaeger\u003c/li\u003e\n\u003cli\u003eOpenTelemetry\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"3-指标监控\"\u003e3. 指标监控\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#3-指标监控\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003ePrometheus\u003c/li\u003e\n\u003cli\u003eGrafana Dashboard\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e核心指标：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eQPS\u003c/li\u003e\n\u003cli\u003eError Rate\u003c/li\u003e\n\u003cli\u003eP99 Latency\u003c/li\u003e\n\u003cli\u003eCPU / Memory\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"4-异常监控与健康检查\"\u003e4. 异常监控与健康检查\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#4-异常监控与健康检查\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eGrafana AlertManager\u003c/li\u003e\n\u003cli\u003eUptimeRobot\u003c/li\u003e\n\u003cli\u003eKubernetes Liveness / Readiness Probe\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"六如何测试高并发\"\u003e六、如何测试高并发\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#六如何测试高并发\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003ch3 id=\"1-压测工具\"\u003e1. 压测工具\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#1-压测工具\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003ewrk\u003c/li\u003e\n\u003cli\u003ehey\u003c/li\u003e\n\u003cli\u003ek6\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"2-压测原则\"\u003e2. 压测原则\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#2-压测原则\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e逐步加压\u003c/li\u003e\n\u003cli\u003e找到瓶颈\u003c/li\u003e\n\u003cli\u003e验证缓存命中率\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"3-常见瓶颈\"\u003e3. 常见瓶颈\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#3-常见瓶颈\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e数据库连接池\u003c/li\u003e\n\u003cli\u003e锁竞争\u003c/li\u003e\n\u003cli\u003eGC\u003c/li\u003e\n\u003cli\u003e网络 IO\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"七如何测试高可用\"\u003e七、如何测试高可用\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#七如何测试高可用\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003ch3 id=\"故障演练chaos-engineering\"\u003e故障演练（Chaos Engineering）\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#故障演练chaos-engineering\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e杀 Pod\u003c/li\u003e\n\u003cli\u003e网络延迟\u003c/li\u003e\n\u003cli\u003eRedis / DB 宕机\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e工具：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eChaos Mesh\u003c/li\u003e\n\u003cli\u003e手动演练\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"八风险兜底服务挂了怎么办\"\u003e八、风险兜底：服务挂了怎么办？\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#八风险兜底服务挂了怎么办\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003ch3 id=\"1-降级\"\u003e1. 降级\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#1-降级\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e关闭非核心功能\u003c/li\u003e\n\u003cli\u003e返回兜底数据\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"2-限流\"\u003e2. 限流\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#2-限流\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eToken Bucket\u003c/li\u003e\n\u003cli\u003eLeaky Bucket\u003c/li\u003e\n\u003cli\u003eRedis / Envoy / NGINX\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"3-熔断\"\u003e3. 熔断\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#3-熔断\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e错误率触发\u003c/li\u003e\n\u003cli\u003e自动恢复\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"4-灾备\"\u003e4. 灾备\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#4-灾备\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e多可用区部署\u003c/li\u003e\n\u003cli\u003e数据备份\u003c/li\u003e\n\u003cli\u003e冷热切换\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"九总结\"\u003e九、总结\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#九总结\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003e一个真正的\u003cstrong\u003e高并发、高可用 Go 云服务\u003c/strong\u003e不是靠某一个中间件堆出来的，而是：\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003e架构设计 + 工程规范 + 自动化运维 + 故障意识\u003c/strong\u003e 的综合结果。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e如果你只能记住一句话：\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003e先保证不挂，再追求更快。\u003c/strong\u003e\u003c/p\u003e\n\u003c/blockquote\u003e"])</script><script>self.__next_f.push([1,"7:[\"$\",\"$L15\",null,{\"postData\":{\"id\":\"highconcuravabackendingo\",\"contentHtml\":\"$16\",\"title\":\"聊聊高并发高可用云服务设计（Go语言版）\",\"date\":\"$D2025-10-25T16:31:07.000Z\",\"categories\":[\"总结\"],\"tags\":[\"高并发\",\"高可用\",\"架构设计\"]}}]\n"])</script><script>self.__next_f.push([1,"10:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\nb:null\n"])</script><script>self.__next_f.push([1,"14:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"聊聊高并发高可用云服务设计（Go语言版）\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"HCHEN90 博客\"}],[\"$\",\"link\",\"2\",{\"rel\":\"alternate\",\"type\":\"application/atom+xml\",\"href\":\"https://hchen90.top/atom.xml\"}],[\"$\",\"link\",\"3\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"16x16\"}]],\"error\":null,\"digest\":\"$undefined\"}\ne:{\"metadata\":\"$14:metadata\",\"error\":null,\"digest\":\"$undefined\"}\n"])</script></body></html>