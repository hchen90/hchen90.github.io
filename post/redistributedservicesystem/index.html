<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/css/283bb1ed86b49fd2.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/09ec4099fb721b31.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/09dfadb69bdaa005.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/54b9acc791aa599c.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-ede82f7d0ae11dac.js"/><script src="/_next/static/chunks/4bd1b696-299743f5624cdabe.js" async=""></script><script src="/_next/static/chunks/684-481501000630d05e.js" async=""></script><script src="/_next/static/chunks/main-app-eb9456c5a3bb7ef4.js" async=""></script><script src="/_next/static/chunks/766-f505dbd3efffaa4c.js" async=""></script><script src="/_next/static/chunks/226-13d4d3f1fc18ceb6.js" async=""></script><script src="/_next/static/chunks/app/layout-b3ce58a25da6999d.js" async=""></script><script src="/_next/static/chunks/874-e909718850e7282e.js" async=""></script><script src="/_next/static/chunks/734-02ba314a893e68e9.js" async=""></script><script src="/_next/static/chunks/351-1a0463ef6ec6e59e.js" async=""></script><script src="/_next/static/chunks/app/post/%5Bid%5D/page-871a46f82159f9c4.js" async=""></script><title>åˆ†å¸ƒå¼æœåŠ¡ç³»ç»Ÿè®¾è®¡æ¦‚è¿°</title><meta name="description" content="HCHEN90 åšå®¢"/><link rel="alternate" type="application/atom+xml" href="https://hchen90.top/atom.xml"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="16x16"/><script>document.querySelectorAll('body link[rel="icon"], body link[rel="apple-touch-icon"]').forEach(el => document.head.appendChild(el))</script><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="antialiased relative"><div class="fixed top-4 right-4 z-50"><a href="https://github.com/hchen90" target="_blank" rel="noopener noreferrer" class="flex items-center justify-center p-2 bg-white rounded-full shadow-md hover:shadow-lg transition-shadow duration-300" title="Visit my GitHub profile"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path></svg></a></div><div class="min-h-screen relative"><div class="fixed top-0 left-0 h-1 bg-blue-500 z-50 transition-all duration-300" style="width:0%"></div><button class="fixed bottom-24 right-8 p-3 rounded-full bg-blue-600 hover:bg-blue-700 text-white shadow-lg transition-opacity duration-300 z-50 opacity-0 pointer-events-none" aria-label="Back to top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 19V5M5 12l7-7 7 7"></path></svg></button><div class="main-content transition-all duration-300"><div class="max-w-4xl mx-auto px-4 py-8"><div class="mb-8"><a class="text-blue-500 hover:underline mb-4 inline-block" href="/">â† è¿”å›é¦–é¡µ</a></div><article><header class="mb-8"><h1 class="text-4xl font-bold mb-4">åˆ†å¸ƒå¼æœåŠ¡ç³»ç»Ÿè®¾è®¡æ¦‚è¿°</h1><div class="text-gray-500 mb-4">2020å¹´12æœˆ20æ—¥</div></header><div class="markdown-content"><h1 id="æ¦‚è¿°ä¸å®šä¹‰">æ¦‚è¿°ä¸å®šä¹‰<a aria-hidden="true" tabindex="-1" href="#æ¦‚è¿°ä¸å®šä¹‰"><span class="anchor-link"> #</span></a></h1>
<p>åˆ†å¸ƒå¼ç³»ç»Ÿæ˜¯ç”±ä¸€ç»„é€šè¿‡ç½‘ç»œååŒå·¥ä½œçš„ç‹¬ç«‹è®¡ç®—æœºï¼ˆèŠ‚ç‚¹ï¼‰ç»„æˆçš„ç³»ç»Ÿã€‚å®ƒä»¬å…±åŒå®Œæˆä¸€é¡¹ä¸šåŠ¡ç›®æ ‡ï¼Œå¹¶å¯¹ç”¨æˆ·å±•ç°ä¸ºâ€œå•ä¸€çš„ç³»ç»Ÿâ€ã€‚ä»ç”¨æˆ·è§†è§’å‡ºå‘ï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿåº”å°½é‡ä¿æŒé€æ˜æ€§ï¼šç”¨æˆ·ä¸éœ€è¦çŸ¥é“è¯·æ±‚è¢«å“ªå°æœºå™¨å¤„ç†ã€æ•°æ®ä½äºå“ªé‡Œï¼Œä¹Ÿä¸åº”æ„ŸçŸ¥åˆ°èŠ‚ç‚¹çš„å¢åˆ ä¸è¿ç§»ã€‚</p>
<p>ä¸€å¥è¯ä»¥æ¦‚ä¹‹ï¼š</p>
<blockquote>
<p><strong>åˆ†å¸ƒå¼ç³»ç»Ÿ = å¤šå°ç‹¬ç«‹çš„è®¡ç®—æœºï¼Œé€šè¿‡ç½‘ç»œåä½œï¼Œå¯¹å¤–è¡¨ç°å¾—åƒä¸€ä¸ªç³»ç»Ÿ</strong></p>
</blockquote>
<p>ç®€è¦è®°ä½ä¸¤ç‚¹ï¼š</p>
<ul>
<li>å¤šèŠ‚ç‚¹åä½œå®ŒæˆåŒä¸€ä¸šåŠ¡ç›®æ ‡ã€‚</li>
<li>å¯¹å¤–è¡¨ç°å°½å¯èƒ½åƒä¸€ä¸ªæ•´ä½“ï¼ˆé€æ˜æ€§ï¼‰ã€‚</li>
</ul>
<blockquote>
<p>æ³¨ï¼šåˆ†å¸ƒå¼ç³»ç»Ÿè®¾è®¡å¸¸å¸¸éœ€è¦åœ¨ä¸€è‡´æ€§ã€å¯ç”¨æ€§ã€åˆ†åŒºå®¹é”™ï¼ˆCAPï¼‰ä¹‹é—´æƒè¡¡ï¼Œå·¥ç¨‹ä¸Šæ™®éé‡‡ç”¨â€œæœ€ç»ˆä¸€è‡´æ€§â€çš„æ€è·¯æ¥æ¢å–é«˜å¯ç”¨ä¸å¯æ‰©å±•ã€‚</p>
</blockquote>
<h2 id="ä¸é›†ä¸­å¼-cs-æ¶æ„å¯¹æ¯”">ä¸é›†ä¸­å¼ C/S æ¶æ„å¯¹æ¯”<a aria-hidden="true" tabindex="-1" href="#ä¸é›†ä¸­å¼-cs-æ¶æ„å¯¹æ¯”"><span class="anchor-link"> #</span></a></h2>
<p>é›†ä¸­å¼ï¼ˆå•ä½“ï¼‰C/S æ¶æ„ç¤ºæ„ï¼š</p>
<p><img src="/post/redistributedservicesystem/a98ad925f117.png" alt="Tra-CS-System"></p>
<p>åˆ†å¸ƒå¼ç³»ç»Ÿå¸¸è§å½¢æ€ï¼š</p>
<p><img src="/post/redistributedservicesystem/29d8d45dfd6d.png" alt="Redi-System"></p>
<h2 id="åˆ†å¸ƒå¼ç³»ç»Ÿä¸ºä»€ä¹ˆéš¾">åˆ†å¸ƒå¼ç³»ç»Ÿä¸ºä»€ä¹ˆâ€œéš¾â€<a aria-hidden="true" tabindex="-1" href="#åˆ†å¸ƒå¼ç³»ç»Ÿä¸ºä»€ä¹ˆéš¾"><span class="anchor-link"> #</span></a></h2>
<p>å•æœºç³»ç»Ÿçš„å‡è®¾åœ¨åˆ†å¸ƒå¼é‡Œå…¨éƒ¨å¤±æ•ˆ ğŸ‘‡</p>
<h3 id="å•æœºä½ é»˜è®¤è®¤ä¸º">å•æœºä½ é»˜è®¤è®¤ä¸ºï¼š<a aria-hidden="true" tabindex="-1" href="#å•æœºä½ é»˜è®¤è®¤ä¸º"><span class="anchor-link"> #</span></a></h3>
<ul>
<li>å†…å­˜å¯é </li>
<li>æ—¶é’Ÿä¸€è‡´</li>
<li>è°ƒç”¨ä¸€å®šæˆåŠŸ</li>
</ul>
<h3 id="åˆ†å¸ƒå¼é‡Œç°å®æ˜¯">åˆ†å¸ƒå¼é‡Œç°å®æ˜¯ï¼š<a aria-hidden="true" tabindex="-1" href="#åˆ†å¸ƒå¼é‡Œç°å®æ˜¯"><span class="anchor-link"> #</span></a></h3>
<ul>
<li>ç½‘ç»œå¯èƒ½æ–­</li>
<li>èŠ‚ç‚¹å¯èƒ½æŒ‚</li>
<li>æ—¶é’Ÿä¸åŒæ­¥</li>
<li>æ¶ˆæ¯å¯èƒ½ä¸¢ / é‡å¤ / å»¶è¿Ÿ</li>
</ul>
<p>ğŸ‘‰ <strong>åˆ†å¸ƒå¼ç³»ç»Ÿ = åœ¨â€œä¸å¯ä¿¡ç¯å¢ƒâ€ä¸‹åšå¯é ç³»ç»Ÿ</strong></p>
<h2 id="åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ ¸å¿ƒé—®é¢˜å¿…é¡»è§£å†³">åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ ¸å¿ƒé—®é¢˜ï¼ˆå¿…é¡»è§£å†³ï¼‰<a aria-hidden="true" tabindex="-1" href="#åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ ¸å¿ƒé—®é¢˜å¿…é¡»è§£å†³"><span class="anchor-link"> #</span></a></h2>
<h3 id="1ï¸âƒ£-é€šä¿¡">1ï¸âƒ£ é€šä¿¡<a aria-hidden="true" tabindex="-1" href="#1ï¸âƒ£-é€šä¿¡"><span class="anchor-link"> #</span></a></h3>
<p>èŠ‚ç‚¹ä¹‹é—´æ€ä¹ˆè¯´è¯ï¼Ÿ</p>
<ul>
<li>HTTP / RPC / gRPC</li>
<li>æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆKafka / RocketMQ / RabbitMQï¼‰</li>
</ul>
<hr>
<h3 id="2ï¸âƒ£-çŠ¶æ€ä¸€è‡´æ€§æœ€æ ¸å¿ƒ">2ï¸âƒ£ çŠ¶æ€ä¸€è‡´æ€§ï¼ˆæœ€æ ¸å¿ƒï¼‰<a aria-hidden="true" tabindex="-1" href="#2ï¸âƒ£-çŠ¶æ€ä¸€è‡´æ€§æœ€æ ¸å¿ƒ"><span class="anchor-link"> #</span></a></h3>
<p>å¤šå°æœºå™¨çš„æ•°æ®æ€ä¹ˆä¿æŒä¸€è‡´ï¼Ÿ</p>
<ul>
<li>å¼ºä¸€è‡´ï¼ˆé“¶è¡Œè½¬è´¦ï¼‰</li>
<li>æœ€ç»ˆä¸€è‡´ï¼ˆç‚¹èµã€æ¨èï¼‰</li>
</ul>
<p>ğŸ‘‰ è¿™ç›´æ¥å¼•å‡º <strong>CAP å®šç†</strong></p>
<hr>
<h3 id="3ï¸âƒ£-å®¹é”™">3ï¸âƒ£ å®¹é”™<a aria-hidden="true" tabindex="-1" href="#3ï¸âƒ£-å®¹é”™"><span class="anchor-link"> #</span></a></h3>
<p>æŸå°æœºå™¨æŒ‚äº†æ€ä¹ˆåŠï¼Ÿ</p>
<ul>
<li>å‰¯æœ¬ï¼ˆReplicaï¼‰</li>
<li>è‡ªåŠ¨åˆ‡æ¢ï¼ˆFailoverï¼‰</li>
<li>é‡è¯• / è¶…æ—¶</li>
</ul>
<hr>
<h3 id="4ï¸âƒ£-æ‰©å±•æ€§">4ï¸âƒ£ æ‰©å±•æ€§<a aria-hidden="true" tabindex="-1" href="#4ï¸âƒ£-æ‰©å±•æ€§"><span class="anchor-link"> #</span></a></h3>
<p>è®¿é—®é‡ç¿» 10 å€æ€ä¹ˆåŠï¼Ÿ</p>
<ul>
<li>åŠ æœºå™¨ï¼ˆHorizontal Scalingï¼‰</li>
<li>è´Ÿè½½å‡è¡¡ï¼ˆLoad Balancerï¼‰</li>
</ul>
<blockquote>
<h2 id="cap-å®šç†åˆ†å¸ƒå¼çš„ç‰©ç†å®šå¾‹">CAP å®šç†ï¼ˆåˆ†å¸ƒå¼çš„â€œç‰©ç†å®šå¾‹â€ï¼‰<a aria-hidden="true" tabindex="-1" href="#cap-å®šç†åˆ†å¸ƒå¼çš„ç‰©ç†å®šå¾‹"><span class="anchor-link"> #</span></a></h2>
<p>åœ¨å‡ºç°ç½‘ç»œåˆ†åŒºï¼ˆPï¼‰æ—¶ï¼Œ<strong>C å’Œ A åªèƒ½é€‰ä¸€ä¸ª</strong></p>
<ul>
<li><strong>Cï¼ˆConsistencyï¼‰</strong>ï¼šä¸€è‡´æ€§</li>
<li><strong>Aï¼ˆAvailabilityï¼‰</strong>ï¼šå¯ç”¨æ€§</li>
<li><strong>Pï¼ˆPartition toleranceï¼‰</strong>ï¼šåˆ†åŒºå®¹é”™ï¼ˆå¿…é¡»è¦ï¼‰</li>
</ul>
<p>ç°å®ç³»ç»Ÿï¼š</p>
<ul>
<li><strong>é‡‘èç³»ç»Ÿ</strong> â†’ CP</li>
<li><strong>ç¤¾äº¤/æ¨è</strong> â†’ AP</li>
</ul>
</blockquote>
<h1 id="è®¾è®¡æ€è·¯æ€»è§ˆ">è®¾è®¡æ€è·¯æ€»è§ˆ<a aria-hidden="true" tabindex="-1" href="#è®¾è®¡æ€è·¯æ€»è§ˆ"><span class="anchor-link"> #</span></a></h1>
<ul>
<li>æ¶ˆæ¯é©±åŠ¨ï¼šç”¨æ¶ˆæ¯ä½œä¸ºæœåŠ¡é—´åä½œçš„â€œç¬¬ä¸€å…¬æ°‘â€ï¼Œå¤©ç„¶è§£è€¦ï¼Œæ˜“æ‰©å±•ã€‚</li>
<li>Actor æ¨¡å‹ï¼šæŠŠæœåŠ¡å®ä¾‹æŠ½è±¡æˆ Actorï¼Œå¤„ç†æ¶ˆæ¯ã€ç»´æŠ¤è‡ªèº«çŠ¶æ€ï¼Œéš”ç¦»å¹¶å‘ã€‚</li>
<li>MongoDB/Postgresï¼šæ¨¡å‹é€‚é…ä¸šåŠ¡å¯¹è±¡ï¼Œæ”¯æŒåˆ†ç‰‡ä¸åˆ†åŒºæˆ–åˆ†é›†ï¼Œåˆ©äºæ‰©å±•ä¸æé«˜é«˜å¯ç”¨ã€‚</li>
<li>Redisï¼šä½œä¸ºè¯»å†™çƒ­ç‚¹çš„é«˜é€Ÿç¼“å­˜ï¼Œä¹Ÿå¯æ‰¿æ‹…é™æµã€çŸ­æœŸé˜Ÿåˆ—ç­‰è§’è‰²ã€‚</li>
<li>Kafka/RocketMQ: ä½œä¸ºç”Ÿäº§è€…/æ¶ˆè´¹è€…çš„æ¶ˆæ¯é€šé“ã€‚</li>
<li>å·¥ç¨‹åŸåˆ™ï¼šè¾¹ç•Œæ¸…æ™°ã€å•ä¸€èŒè´£ã€å¹‚ç­‰ä¸é‡è¯•ã€å°½é‡æ— çŠ¶æ€ï¼ˆå°¤å…¶æ˜¯ç½‘å…³å±‚ï¼‰ã€‚</li>
</ul>
<hr>
<h2 id="actor-æ¨¡å‹">Actor æ¨¡å‹<a aria-hidden="true" tabindex="-1" href="#actor-æ¨¡å‹"><span class="anchor-link"> #</span></a></h2>
<p>Actorçš„ç†è®ºæ€§å¯¹åº”åˆ°å®é™…å·¥ç¨‹åœºæ™¯å…¶å®å°±æ˜¯å…·å¤‡è‡ªæœ‰çŠ¶æ€çš„å¾®æœåŠ¡å­æ¨¡å—ã€‚</p>
<blockquote>
<p>å‚è€ƒç»´åŸºç™¾ç§‘ï¼š<a href="https://en.wikipedia.org/wiki/Actor_model">Actor Model</a></p>
</blockquote>
<p>Actor æ˜¯ä¸€ä¸ªåŸºæœ¬çš„è®¡ç®—å•å…ƒï¼š</p>
<ul>
<li>æ¥æ”¶æ¶ˆæ¯ï¼ˆMailboxï¼‰ã€‚</li>
<li>åŸºäºå½“å‰çŠ¶æ€ä¸è¡Œä¸ºå¤„ç†æ¶ˆæ¯ï¼ˆBehavior + Stateï¼‰ã€‚</li>
<li>äº§ç”Ÿæ–°çš„çŠ¶æ€ä¸å¯é€‰çš„å“åº”æ¶ˆæ¯ã€‚</li>
</ul>
<p>Actor ä¹‹é—´å½¼æ­¤éš”ç¦»ï¼Œä¸å…±äº«å†…å­˜ï¼Œé æ¶ˆæ¯é€šä¿¡å®Œæˆåä½œã€‚è¿™ç§æ¨¡å‹ç‰¹åˆ«é€‚åˆé«˜å¹¶å‘ã€å¼ºéš”ç¦»çš„åˆ†å¸ƒå¼åœºæ™¯ã€‚</p>
<p><img src="/post/redistributedservicesystem/1104498e5f0a.png" alt="Actor Model"></p>
<p>åœ¨ç³»ç»Ÿåˆ†å±‚ä¸­ï¼Œå¯ä»¥æŠŠâ€œæœåŠ¡ Nâ€æŠ½è±¡ä¸ºä¸€ç»„ Actorï¼šæ¯ä¸ªæœåŠ¡è¢«æ‹†åˆ†ä¸ºè‹¥å¹²èŒè´£å•ä¸€çš„ Actorï¼Œåˆ†åˆ«è´Ÿè´£ä¼šè¯ã€è®¢å•ã€åº“å­˜ã€ç»“ç®—ç­‰å­åŸŸé€»è¾‘ã€‚è¿™æ ·æ—¢é™ä½äº†è€¦åˆï¼Œä¹Ÿåˆ©äºä¼¸ç¼©ã€‚</p>
<h3 id="çŠ¶æ€æœºfsmä¸-actor">çŠ¶æ€æœºï¼ˆFSMï¼‰ä¸ Actor<a aria-hidden="true" tabindex="-1" href="#çŠ¶æ€æœºfsmä¸-actor"><span class="anchor-link"> #</span></a></h3>
<p>å¾ˆå¤š Actor å†…éƒ¨å¯ç”¨æœ‰é™çŠ¶æ€æœºï¼ˆFSMï¼‰æ¥ç»„ç»‡é€»è¾‘ã€‚FSM çš„å››è¦ç´ ï¼š</p>
<ul>
<li>çŠ¶æ€ï¼ˆStateï¼‰</li>
<li>äº‹ä»¶ï¼ˆEventï¼‰</li>
<li>åŠ¨ä½œï¼ˆActionï¼‰</li>
<li>å˜æ¢ï¼ˆTransitionï¼‰</li>
</ul>
<p>çŠ¶æ€æœºä»â€œå¼€å§‹æ€â€å‡ºå‘ï¼Œåœ¨äº‹ä»¶è§¦å‘ä¸‹è¿ç§»åˆ°ä¸‹ä¸€çŠ¶æ€å¹¶æ‰§è¡Œç›¸åº”åŠ¨ä½œï¼Œæœ€ç»ˆåˆ°è¾¾â€œç»“æŸæ€â€ã€‚æŠŠçŠ¶æ€æœºè§†ä¸ºä¸€ä¸ªâ€œé»‘ç›’â€ï¼Œå¯¹å¤–åªæš´éœ²äº‹ä»¶ä¸ç»“æœï¼Œå¯ä»¥å¾ˆå¥½åœ°å®ç°å†…éƒ¨ä¿¡æ¯éš”ç¦»ä¸çŠ¶æ€å®‰å…¨ã€‚</p>
<hr>
<h2 id="æ•°æ®å±‚mongodbpostgres">æ•°æ®å±‚ï¼šMongoDB/Postgres<a aria-hidden="true" tabindex="-1" href="#æ•°æ®å±‚mongodbpostgres"><span class="anchor-link"> #</span></a></h2>
<p>MongoDB éå¸¸å¥‘åˆåˆ†å¸ƒå¼ç³»ç»Ÿï¼š</p>
<ul>
<li>æ•°æ®æ¨¡å‹ï¼ˆDocument/Collection/Tableï¼‰æ¥è¿‘ä¸šåŠ¡<strong>å¯¹è±¡ç»“æ„</strong>ï¼Œè¯»å†™è‡ªç„¶ã€‚</li>
<li>åˆ†ç‰‡ï¼ˆShardingï¼‰ä¸ºæ°´å¹³æ‰©å±•è€Œç”Ÿï¼Œå¯æŠŠæ•°æ®æŒ‰é”®å‡è¡¡åˆ†å¸ƒåˆ°å¤šèŠ‚ç‚¹ã€‚</li>
<li>å‰¯æœ¬é›†ï¼ˆReplica Setï¼‰æä¾›é«˜å¯ç”¨ä¸è¯»å†™åˆ†ç¦»ç­–ç•¥ã€‚</li>
<li>ä¸€è‡´æ€§ä¸äº‹åŠ¡ï¼šæ”¯æŒå¤šæ–‡æ¡£äº‹åŠ¡ï¼Œä½†å·¥ç¨‹ä¸Šå¸¸ä»¥â€œæœ€ç»ˆä¸€è‡´æ€§ + å¹‚ç­‰è¡¥å¿â€é™ä½è€¦åˆä¸å¼€é”€ã€‚</li>
</ul>
<p><img src="/post/redistributedservicesystem/7ea8177a86d6.png" alt="mongo-db"></p>
<p>å·¥ç¨‹å®è·µä¸­çš„å»ºè®®ï¼š</p>
<ul>
<li>è®¾è®¡å¥½åˆ†ç‰‡é”®ï¼ˆé«˜åŸºæ•°ã€å†™å…¥å‡åŒ€ã€æŸ¥è¯¢å‘½ä¸­é«˜ï¼‰ã€‚</li>
<li>ç»“åˆå‰¯æœ¬é›†èŠ‚ç‚¹è§’è‰²åšè¯»å†™ç­–ç•¥ï¼ˆprimary writeï¼Œsecondary readï¼‰ã€‚</li>
<li>ç”¨åˆç†çš„ç´¢å¼•ä¸ TTL ç´¢å¼•ç®¡ç†çƒ­æ•°æ®ä¸å†å²æ•°æ®ã€‚</li>
</ul>
<blockquote>
<p>è¦ç”¨å¥½ORMï¼Œåœ¨Goè¯­è¨€ä¸­æœ‰ä¸ªgormå¾ˆå—æ¬¢è¿ã€‚</p>
</blockquote>
<h2 id="ç¼“å­˜å±‚redis">ç¼“å­˜å±‚ï¼šRedis<a aria-hidden="true" tabindex="-1" href="#ç¼“å­˜å±‚redis"><span class="anchor-link"> #</span></a></h2>
<p>Redis åœ¨è¯¥ä½“ç³»ä¸­çš„å®šä½ï¼š</p>
<ul>
<li>çƒ­ç‚¹æ•°æ®ç¼“å­˜ï¼šé™ä½æ•°æ®åº“å‹åŠ›ï¼Œæå‡è¯»æ€§èƒ½ï¼ˆå¯ç”¨ Cache-Aside/Read-Through/Write-Through ç­‰ç­–ç•¥ï¼‰ã€‚</li>
<li>çŸ­æœŸé˜Ÿåˆ—ä¸é™æµï¼šåŸºäº List/Stream/ä»¤ç‰Œæ¡¶å®ç°ç®€å•é˜Ÿåˆ—ä¸é™æµã€‚</li>
<li>ä¼šè¯ä¸ä¸´æ—¶æ€ï¼šå­˜å‚¨çŸ­æœŸä¼šè¯ã€å¹‚ç­‰ä»¤ç‰Œã€åˆ†å¸ƒå¼é”ç­‰ã€‚</li>
</ul>
<p><img src="/post/redistributedservicesystem/b23b8e305828.png" alt="redis"></p>
<p>æ³¨æ„å…¸å‹é£é™©ä¸å¯¹ç­–ï¼š</p>
<ul>
<li>ç¼“å­˜ç©¿é€ï¼šä¸ºä¸å­˜åœ¨çš„é”®å¢åŠ ç©ºå€¼ç¼“å­˜ + å¸ƒéš†è¿‡æ»¤å™¨ã€‚</li>
<li>ç¼“å­˜å‡»ç©¿ï¼šå¯¹çƒ­ç‚¹ Key å¢åŠ äº’æ–¥æ›´æ–°æˆ–ä½¿ç”¨é€»è¾‘è¿‡æœŸ + åå°åˆ·æ–°ã€‚</li>
<li>ç¼“å­˜é›ªå´©ï¼šè¿‡æœŸæ—¶é—´éšæœºåŒ–ï¼Œè®¾ç½®å¤šçº§é™æµä¸é™çº§ç­–ç•¥ã€‚</li>
</ul>
<hr>
<h2 id="æœåŠ¡å‘ç°ä¸é…ç½®etcd">æœåŠ¡å‘ç°ä¸é…ç½®ï¼šetcd<a aria-hidden="true" tabindex="-1" href="#æœåŠ¡å‘ç°ä¸é…ç½®etcd"><span class="anchor-link"> #</span></a></h2>
<p>etcd æ˜¯ä¸€ä¸ªåŸºäº Raft å…±è¯†ç®—æ³•çš„åˆ†å¸ƒå¼é”®å€¼å­˜å‚¨ï¼Œå¸¸ç”¨äºæœåŠ¡æ³¨å†Œä¸å‘ç°ã€åŠ¨æ€é…ç½®ä¸åˆ†å¸ƒå¼åè°ƒï¼š</p>
<ul>
<li>æœåŠ¡æ³¨å†Œä¸å‘ç°ï¼š
<ul>
<li>æ³¨å†Œï¼šå®ä¾‹ä»¥ç§Ÿçº¦ï¼ˆLease + TTLï¼‰çš„æ–¹å¼åœ¨ <code>/services/{name}/{instanceId}</code> ä¸‹å†™å…¥è‡ªèº«åœ°å€ä¸å…ƒä¿¡æ¯ï¼Œå¹¶å®šæœŸ KeepAliveã€‚</li>
<li>å‘ç°ï¼šç½‘å…³æˆ–è°ƒç”¨æ–¹ Watch å¯¹åº”å‰ç¼€å˜åŒ–ï¼Œæ„ŸçŸ¥å®ä¾‹ä¸Šä¸‹çº¿å¹¶æ›´æ–°æœ¬åœ°è·¯ç”±ã€‚</li>
<li>å¥å£®æ€§ï¼šç§Ÿçº¦åˆ°æœŸè‡ªåŠ¨åˆ é™¤é”®ï¼Œé¿å…â€œåƒµå°¸å®ä¾‹â€ï¼›å®¢æˆ·ç«¯åº”å®ç°æŒ‡æ•°é€€é¿ä¸æŠ–åŠ¨é‡è¿ã€‚</li>
</ul>
</li>
<li>åŠ¨æ€é…ç½®ï¼š
<ul>
<li>å°†é…ç½®ç»„ç»‡åœ¨ <code>/config/{app}/{env}/</code> å‰ç¼€ä¸‹ï¼Œå‘å¸ƒæ–¹å†™å…¥ï¼Œå®¢æˆ·ç«¯ Watch å¹¶çƒ­æ›´æ–°ã€‚</li>
<li>å¤§ä½“é‡é…ç½®å»ºè®®æ‹†åˆ†æ¨¡å—/åˆ†æ®µåŠ è½½ï¼›æ•æ„Ÿé…ç½®éœ€é…åˆåŠ å¯†æˆ–ä¸“ç”¨é…ç½®ä¸­å¿ƒã€‚</li>
</ul>
</li>
<li>åè°ƒèƒ½åŠ›ï¼š
<ul>
<li>åˆ†å¸ƒå¼é”/Leader é€‰ä¸¾ï¼šä½¿ç”¨ etcd concurrency APIï¼ˆåŸºäºä¼šè¯çš„ Mutex/Campaignï¼‰ã€‚</li>
<li>å…¸å‹ç”¨é€”ï¼šä»»åŠ¡åˆ†ç‰‡è°ƒåº¦ã€å•ä¸»å†™å…¥ã€é™æµé…é¢çš„é›†ä¸­ä»²è£ã€‚</li>
</ul>
</li>
<li>è¿ç»´è¦ç‚¹ï¼š
<ul>
<li>é›†ç¾¤è§„æ¨¡ä»¥ 3 æˆ– 5 èŠ‚ç‚¹ä¸ºå®œï¼ˆå¥‡æ•°æŠ•ç¥¨ï¼Œè¿‡å¤§åè€Œé™ä½å†™æ€§èƒ½ï¼‰ã€‚</li>
<li>åˆç†è®¾ç½®å¿«ç…§ä¸å‹ç¼©ï¼ˆCompactionï¼‰ï¼Œé¿å… Watch Backlog è¿‡å¤§ï¼›å¯¹é«˜å»¶è¿Ÿé“¾è·¯è®¾ç½®è¶…æ—¶ä¸å¿ƒè·³é˜ˆå€¼ã€‚</li>
</ul>
</li>
</ul>
<p>åœ¨æœ¬æ–‡æ¶æ„ä¸­ï¼Œetcd æ‰¿æ‹…â€œæœåŠ¡æ³¨å†Œä¸å‘ç° + åŠ¨æ€é…ç½® + åè°ƒåŸè¯­â€çš„åŸºç¡€è®¾æ–½è§’è‰²ï¼Œè¾…åŠ©ç½‘å…³è·¯ç”±ä¸å†…éƒ¨æœåŠ¡å¯»å€ã€‚</p>
<hr>
<h2 id="é€šä¿¡ä¸ä¸€è‡´æ€§ç­–ç•¥">é€šä¿¡ä¸ä¸€è‡´æ€§ç­–ç•¥<a aria-hidden="true" tabindex="-1" href="#é€šä¿¡ä¸ä¸€è‡´æ€§ç­–ç•¥"><span class="anchor-link"> #</span></a></h2>
<ul>
<li>é€šä¿¡æ–¹å¼ï¼š
- åŒæ­¥ RPCï¼ˆHTTP/gRPCï¼‰ç”¨äºå¼ºå®æ—¶ã€å¼ºä¸€è‡´çš„å°é—­ç¯ã€‚
- å¼‚æ­¥æ¶ˆæ¯æ€»çº¿ç”¨äºè§£è€¦ä¸å‰Šå³°å¡«è°·ï¼ˆRocketMQ/Kafka/RabbitMQ/Redis Stream ç­‰ï¼‰ã€‚</li>
<li>é‡è¯•ä¸å¹‚ç­‰ï¼š
<ul>
<li>ä¸‹æ¸¸çŸ­æš‚ä¸å¯ç”¨æ—¶å¯é‡è¯•ï¼›æ‰€æœ‰å¯é‡è¯•çš„å†™æ“ä½œå¿…é¡»å¹‚ç­‰ï¼ˆå»é‡é”®ã€å¹‚ç­‰ä»¤ç‰Œï¼‰ã€‚</li>
</ul>
</li>
<li>æœ€ç»ˆä¸€è‡´æ€§ï¼š
<ul>
<li>Saga/Outbox Patternï¼šç”¨æœ¬åœ°äº‹åŠ¡ + äº‹ä»¶å¤–å‘ä¿è¯å˜æ›´å¯è¾¾ï¼Œå¤±è´¥åˆ™ç¼–æ’è¡¥å¿ã€‚</li>
</ul>
</li>
<li>å…¨å±€æ ‡è¯†ï¼š
<ul>
<li>é›ªèŠ±ç®—æ³•/å·æ®µç¼“å­˜ç”Ÿæˆå¯æ’åºçš„åˆ†å¸ƒå¼ IDï¼Œä¾¿äºè·¯ç”±ä¸å®¡è®¡ã€‚</li>
</ul>
</li>
</ul>
<hr>
<h2 id="æ¶ˆæ¯ä¸­é—´ä»¶rocketmqkafka">æ¶ˆæ¯ä¸­é—´ä»¶ï¼šRocketMQ/Kafka<a aria-hidden="true" tabindex="-1" href="#æ¶ˆæ¯ä¸­é—´ä»¶rocketmqkafka"><span class="anchor-link"> #</span></a></h2>
<p>RocketMQ/Kafkaè¿™ç±»æ˜¯é«˜æ€§èƒ½ã€ä½å»¶è¿Ÿçš„åˆ†å¸ƒå¼æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œå…·æœ‰å®Œå¤‡çš„æ¶ˆæ¯è¯­ä¹‰ä¸ä¼ä¸šçº§ç‰¹æ€§ï¼š</p>
<ul>
<li>æ ¸å¿ƒæ¦‚å¿µï¼šTopicã€Tagã€Message Keyã€Producer Groupã€Consumer Groupã€‚</li>
<li>æŠ•é€’è¯­ä¹‰ï¼šé»˜è®¤è‡³å°‘ä¸€æ¬¡ï¼ˆAt-Least-Onceï¼‰ï¼Œç²¾ç¡®ä¸€æ¬¡éœ€åœ¨ä¸šåŠ¡å±‚é€šè¿‡å¹‚ç­‰é”®/å»é‡è¡¨å®ç°ã€‚</li>
<li>é¡ºåºæ¶ˆæ¯ï¼šåŸºäºåˆ†ç‰‡é”®ï¼ˆSharding Keyï¼‰åœ¨é˜Ÿåˆ—å†…ä¿è¯å±€éƒ¨æœ‰åºï¼Œé€‚ç”¨äºè®¢å•çŠ¶æ€æµã€èµ„é‡‘æµæ°´ç­‰åœºæ™¯ã€‚</li>
<li>äº‹åŠ¡æ¶ˆæ¯ï¼š
<ul>
<li>æµç¨‹ï¼šå‘é€åŠæ¶ˆæ¯ï¼ˆPrepareï¼‰â†’ æ‰§è¡Œæœ¬åœ°äº‹åŠ¡ â†’ Commit/Rollbackï¼›</li>
<li>Broker å¯å›æŸ¥äº‹åŠ¡çŠ¶æ€ï¼ˆTransaction Checkï¼‰ä»¥é˜²æ‚¬æŒ‚ï¼Œç”Ÿäº§è€…éœ€å®ç°å›æŸ¥æ¥å£ï¼›</li>
<li>å¸¸ç”¨äº Saga/Outbox çš„å¯é äº‹ä»¶å¤–å‘ã€‚</li>
</ul>
</li>
<li>å»¶è¿Ÿ/å®šæ—¶æ¶ˆæ¯ï¼šå†…å»ºå¤šçº§å»¶è¿Ÿï¼›é…åˆé‡è¯•ç­–ç•¥å®ç°æŸ”æ€§äº‹åŠ¡ä¸å‰Šå³°ã€‚</li>
<li>é‡è¯•ä¸æ­»ä¿¡ï¼š
<ul>
<li>æ¶ˆè´¹å¤±è´¥æŒ‰é‡è¯•ç­–ç•¥å›æŠ•ï¼Œè¶…è¿‡é˜ˆå€¼è¿›å…¥ DLQï¼ˆæ­»ä¿¡é˜Ÿåˆ—ï¼‰ï¼Œä¾¿äºæ’æŸ¥ä¸äººå·¥è¡¥å¿ã€‚</li>
</ul>
</li>
<li>æ¶ˆè´¹æ¨¡å¼ï¼šé›†ç¾¤ï¼ˆè´Ÿè½½å‡è¡¡ï¼‰ä¸å¹¿æ’­ï¼ˆå…¨éƒ¨æ¶ˆè´¹ï¼‰ï¼›é€šå¸¸ä¸šåŠ¡æ¶ˆè´¹é‡‡ç”¨é›†ç¾¤æ¨¡å¼ã€‚</li>
<li>è®¾è®¡å»ºè®®ï¼š
<ul>
<li>æ¶ˆæ¯å¹‚ç­‰ï¼šä½¿ç”¨ä¸šåŠ¡å”¯ä¸€é”®ï¼ˆå¦‚è®¢å•å·ï¼‰å»é‡ï¼›æ¶ˆè´¹è€…ä¾§â€œå…ˆåˆ¤é‡åæ‰§è¡Œâ€ã€‚</li>
<li>è´Ÿè½½ä¸æ‰©å±•ï¼šæŒ‰ååä¸æœ‰åºéœ€æ±‚è§„åˆ’é˜Ÿåˆ—æ•°ï¼›é¿å…æ¶ˆæ¯ä½“è¿‡å¤§ï¼ˆå»ºè®® &#x3C; 1MBï¼‰ï¼Œå¤§å¯¹è±¡èµ°å­˜å‚¨ï¼Œæ¶ˆæ¯åªæ”¾å¼•ç”¨ã€‚</li>
<li>å¯è§‚æµ‹ï¼šå¼€å¯æ¶ˆæ¯è½¨è¿¹ä¸æŒ‡æ ‡ä¸ŠæŠ¥ï¼Œå…³æ³¨å †ç§¯ã€è€—æ—¶ä¸å›æŸ¥æ¯”ä¾‹ã€‚</li>
</ul>
</li>
</ul>
<p>åœ¨æ¶æ„ä¸­ï¼ŒRocketMQ/Kafka ä½œä¸ºâ€œäº‹ä»¶æ€»çº¿â€ï¼Œæ”¯æ’‘è·¨æœåŠ¡è§£è€¦ã€å‰Šå³°å¡«è°·ä¸æœ€ç»ˆä¸€è‡´æ€§ï¼š</p>
<ul>
<li>Outboxï¼šä¸šåŠ¡è¡¨ + outbox è¡¨æœ¬åœ°äº‹åŠ¡æäº¤ï¼Œåå°å‘å¸ƒåˆ° RocketMQï¼Œæ¶ˆè´¹ä¾§å¹‚ç­‰å…¥åº“ã€‚</li>
<li>Sagaï¼šç¼–æ’å™¨åŸºäºäº‹ä»¶æ¨è¿›/å›æ»šæ­¥éª¤ï¼Œå¤±è´¥èµ°è¡¥å¿æ¶ˆæ¯ã€‚</li>
</ul>
<hr>
<h2 id="æ‹“æ‰‘ä¸éƒ¨ç½²">æ‹“æ‰‘ä¸éƒ¨ç½²<a aria-hidden="true" tabindex="-1" href="#æ‹“æ‰‘ä¸éƒ¨ç½²"><span class="anchor-link"> #</span></a></h2>
<p>å…¸å‹æ‹“æ‰‘ï¼š</p>
<ul>
<li>ç½‘å…³ï¼ˆGatewayï¼‰ï¼šå¯¹å¤–å”¯ä¸€å…¥å£ï¼Œåšé‰´æƒã€è·¯ç”±ã€é™æµä¸èšåˆã€‚</li>
<li>æœåŠ¡æ³¨å†Œä¸å‘ç°ï¼šåŸºäº etcd çš„æ³¨å†Œè¡¨ä¸ Watchï¼Œå®ç°åŠ¨æ€å¯»å€ä¸å¥åº·æ£€æŸ¥ï¼ˆä¹Ÿå¯é…åˆ Sidecarï¼‰ã€‚</li>
<li>å†…éƒ¨æœåŠ¡ï¼šæŒ‰åŸŸåˆ’åˆ†çš„å¾®æœåŠ¡/Actor ç¾¤ç»„ï¼Œäº’ç›¸é€šè¿‡ RPC/æ¶ˆæ¯äº¤äº’ã€‚</li>
<li>æ•°æ®ä¸ç¼“å­˜å±‚ï¼šMongoDB é›†ç¾¤ + Redis é›†ç¾¤ï¼Œç»“åˆå‰¯æœ¬é›†ã€å“¨å…µä¸åˆ†ç‰‡è®¾è®¡ã€‚</li>
<li>æ¶ˆæ¯å±‚ï¼šRocketMQ Broker é›†ç¾¤ + NameServerï¼ŒæŒ‰ Topic/é˜Ÿåˆ—æ‰©å±•ååã€‚</li>
</ul>
<p><img src="/post/redistributedservicesystem/a5b1f3959027.png" alt="diagram"></p>
<hr>
<h2 id="é€‚ç”¨åœºæ™¯">é€‚ç”¨åœºæ™¯<a aria-hidden="true" tabindex="-1" href="#é€‚ç”¨åœºæ™¯"><span class="anchor-link"> #</span></a></h2>
<ul>
<li>å¤§é‡å¹¶å‘æ¥å…¥ï¼ˆæµ·é‡ç”¨æˆ·ã€IoT è®¾å¤‡ã€æ¸¸æˆç½‘å…³ç­‰ï¼‰ã€‚</li>
<li>æ•°æ®è§„æ¨¡åºå¤§ï¼Œéœ€è¦æ°´å¹³æ‰©å®¹ä¸å¼¹æ€§ï¼ˆæ—¥å¿—/è®¢å•/å†…å®¹å¹³å°ç­‰ï¼‰ã€‚</li>
<li>å¯¹é«˜å¯ç”¨æœ‰ç¡¬æ€§è¦æ±‚ï¼ˆé‡‘èæ”¯ä»˜éƒ¨åˆ†ç¯èŠ‚ã€æ ¸å¿ƒäº¤æ˜“è¯»è·¯å¾„ç­‰ï¼‰ã€‚</li>
</ul>
<hr>
<h2 id="å°ç»“">å°ç»“<a aria-hidden="true" tabindex="-1" href="#å°ç»“"><span class="anchor-link"> #</span></a></h2>
<p>è¿™å¥—â€œæ¶ˆæ¯é©±åŠ¨ + Actor + MongoDB/Redisâ€çš„ç»„åˆï¼Œå·¥ç¨‹è·¯å¾„æ¸…æ™°ã€ç”Ÿæ€æˆç†Ÿï¼šå½“æ€§èƒ½ä¸å¤Ÿæ—¶é€šè¿‡å¢åŠ èŠ‚ç‚¹æ‰©å®¹ï¼›å½“æ•°æ®å¢å¤§æ—¶é€šè¿‡ MongoDB åˆ†ç‰‡æ‰©å±•ï¼›å½“è¯»å†™å‹åŠ›ä¸å‡æ—¶å€ŸåŠ© Redis ç¼“å­˜ä¸é™æµå‰Šå³°ã€‚çœŸæ­£çš„éš¾ç‚¹ä¸åœ¨â€œèƒ½å¦å·¥ä½œâ€ï¼Œè€Œåœ¨â€œèƒ½å¦ä¼˜é›…åœ°æ‰©å±•ä¸è¿ç»´â€ã€‚</p>
<p>ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä¼šåœ¨åç»­åšæ–‡ä¸­ç»“åˆå…·ä½“çš„è®¾è®¡å·¥å…·ä¸ä»£ç ï¼Œæ­å»ºä¸€ä¸ªâ€œå¾®å‹åˆ†å¸ƒå¼æœåŠ¡ç³»ç»Ÿâ€çš„ç«¯åˆ°ç«¯æ ·ä¾‹ï¼Œè¦†ç›–æœåŠ¡æ‹†åˆ†ã€é€šä¿¡ã€ç¼“å­˜ã€ä¸€è‡´æ€§ä¸è§‚æµ‹çš„æœ€å°é—­ç¯ã€‚</p></div><div class="mt-12 pt-6 border-t border-gray-200 dark:border-gray-700"><a class="text-blue-500 hover:underline" href="/">â† è¿”å›æ‰€æœ‰æ–‡ç« åˆ—è¡¨</a></div><div class="mt-8 pt-4 border-t border-gray-200 dark:border-gray-700 text-center text-gray-500 text-sm">Â© 2013 â€“ 2025 é™ˆç¥¥</div></article></div></div></div><!--$--><!--/$--><!--$--><!--/$--><script src="/_next/static/chunks/webpack-ede82f7d0ae11dac.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[7555,[],\"\"]\n3:I[1295,[],\"\"]\n4:I[415,[\"766\",\"static/chunks/766-f505dbd3efffaa4c.js\",\"226\",\"static/chunks/226-13d4d3f1fc18ceb6.js\",\"177\",\"static/chunks/app/layout-b3ce58a25da6999d.js\"],\"default\"]\n5:I[9243,[\"766\",\"static/chunks/766-f505dbd3efffaa4c.js\",\"226\",\"static/chunks/226-13d4d3f1fc18ceb6.js\",\"177\",\"static/chunks/app/layout-b3ce58a25da6999d.js\"],\"\"]\n8:I[9665,[],\"MetadataBoundary\"]\na:I[9665,[],\"OutletBoundary\"]\nd:I[4911,[],\"AsyncMetadataOutlet\"]\nf:I[9665,[],\"ViewportBoundary\"]\n11:I[6614,[],\"\"]\n:HL[\"/_next/static/css/283bb1ed86b49fd2.css\",\"style\"]\n:HL[\"/_next/static/css/09ec4099fb721b31.css\",\"style\"]\n:HL[\"/_next/static/css/09dfadb69bdaa005.css\",\"style\"]\n:HL[\"/_next/static/css/54b9acc791aa599c.css\",\"style\"]\n6:T4a2,\n          function copyCode(button) {\n            // Find the code element within the same wrapper\n            const codeWrapper = button.closest('.code-block-wrapper');\n            if (!codeWrapper) return;\n            \n            const codeElement = codeWrapper.querySelector('code');\n            if (!codeElement) return;\n            \n            // Get the text content\n            const text = codeElement.textContent;\n            \n            // Use the clipboard API to copy the text\n            navigator.clipboard.writeText(text).then(() =\u003e {\n              // Update the button state to show \"Copied!\"\n              button.setAttribute('data-copy-state', 'copied');\n              const buttonText = button.querySelector('.copy-button-text');\n              if (buttonText) buttonText.textContent = 'Copied!';\n              \n              // Reset after 2 seconds\n              setTimeout(() =\u003e {\n                button.setAttribute('data-copy-state', 'copy');\n                if (buttonText) buttonText.textContent = 'Copy';\n              }, 2000);\n            }).catch(err =\u003e {\n              console.error('Failed to copy text: ', err);\n            });\n          }\n          "])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"xsQ5PUF4c2cJqxppneo-C\",\"p\":\"\",\"c\":[\"\",\"post\",\"redistributedservicesystem\",\"\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"post\",{\"children\":[[\"id\",\"redistributedservicesystem\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/283bb1ed86b49fd2.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/09ec4099fb721b31.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"2\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/09dfadb69bdaa005.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"className\":\"antialiased relative\",\"children\":[[\"$\",\"div\",null,{\"className\":\"fixed top-4 right-4 z-50\",\"children\":[\"$\",\"a\",null,{\"href\":\"https://github.com/hchen90\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"className\":\"flex items-center justify-center p-2 bg-white rounded-full shadow-md hover:shadow-lg transition-shadow duration-300\",\"title\":\"Visit my GitHub profile\",\"children\":[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":\"24\",\"height\":\"24\",\"viewBox\":\"0 0 24 24\",\"fill\":\"currentColor\",\"children\":[\"$\",\"path\",null,{\"d\":\"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z\"}]}]}]}],[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}],[\"$\",\"$L4\",null,{}],[\"$\",\"$L5\",null,{\"id\":\"code-copy\",\"children\":\"$6\"}]]}]}]]}],{\"children\":[\"post\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"id\",\"redistributedservicesystem\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L7\",[\"$\",\"$L8\",null,{\"children\":\"$L9\"}],[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/54b9acc791aa599c.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"$La\",null,{\"children\":[\"$Lb\",\"$Lc\",[\"$\",\"$Ld\",null,{\"promise\":\"$@e\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"pByEHBVZQNoPhpw16CzDi\",{\"children\":[[\"$\",\"$Lf\",null,{\"children\":\"$L10\"}],null]}],null]}],false]],\"m\":\"$undefined\",\"G\":[\"$11\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"12:\"$Sreact.suspense\"\n13:I[4911,[],\"AsyncMetadata\"]\n9:[\"$\",\"$12\",null,{\"fallback\":null,\"children\":[\"$\",\"$L13\",null,{\"promise\":\"$@14\"}]}]\n"])</script><script>self.__next_f.push([1,"c:null\n"])</script><script>self.__next_f.push([1,"15:I[9543,[\"874\",\"static/chunks/874-e909718850e7282e.js\",\"734\",\"static/chunks/734-02ba314a893e68e9.js\",\"351\",\"static/chunks/351-1a0463ef6ec6e59e.js\",\"457\",\"static/chunks/app/post/%5Bid%5D/page-871a46f82159f9c4.js\"],\"default\"]\n16:T3cef,"])</script><script>self.__next_f.push([1,"\u003ch1 id=\"æ¦‚è¿°ä¸å®šä¹‰\"\u003eæ¦‚è¿°ä¸å®šä¹‰\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#æ¦‚è¿°ä¸å®šä¹‰\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003cp\u003eåˆ†å¸ƒå¼ç³»ç»Ÿæ˜¯ç”±ä¸€ç»„é€šè¿‡ç½‘ç»œååŒå·¥ä½œçš„ç‹¬ç«‹è®¡ç®—æœºï¼ˆèŠ‚ç‚¹ï¼‰ç»„æˆçš„ç³»ç»Ÿã€‚å®ƒä»¬å…±åŒå®Œæˆä¸€é¡¹ä¸šåŠ¡ç›®æ ‡ï¼Œå¹¶å¯¹ç”¨æˆ·å±•ç°ä¸ºâ€œå•ä¸€çš„ç³»ç»Ÿâ€ã€‚ä»ç”¨æˆ·è§†è§’å‡ºå‘ï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿåº”å°½é‡ä¿æŒé€æ˜æ€§ï¼šç”¨æˆ·ä¸éœ€è¦çŸ¥é“è¯·æ±‚è¢«å“ªå°æœºå™¨å¤„ç†ã€æ•°æ®ä½äºå“ªé‡Œï¼Œä¹Ÿä¸åº”æ„ŸçŸ¥åˆ°èŠ‚ç‚¹çš„å¢åˆ ä¸è¿ç§»ã€‚\u003c/p\u003e\n\u003cp\u003eä¸€å¥è¯ä»¥æ¦‚ä¹‹ï¼š\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003eåˆ†å¸ƒå¼ç³»ç»Ÿ = å¤šå°ç‹¬ç«‹çš„è®¡ç®—æœºï¼Œé€šè¿‡ç½‘ç»œåä½œï¼Œå¯¹å¤–è¡¨ç°å¾—åƒä¸€ä¸ªç³»ç»Ÿ\u003c/strong\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eç®€è¦è®°ä½ä¸¤ç‚¹ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eå¤šèŠ‚ç‚¹åä½œå®ŒæˆåŒä¸€ä¸šåŠ¡ç›®æ ‡ã€‚\u003c/li\u003e\n\u003cli\u003eå¯¹å¤–è¡¨ç°å°½å¯èƒ½åƒä¸€ä¸ªæ•´ä½“ï¼ˆé€æ˜æ€§ï¼‰ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003eæ³¨ï¼šåˆ†å¸ƒå¼ç³»ç»Ÿè®¾è®¡å¸¸å¸¸éœ€è¦åœ¨ä¸€è‡´æ€§ã€å¯ç”¨æ€§ã€åˆ†åŒºå®¹é”™ï¼ˆCAPï¼‰ä¹‹é—´æƒè¡¡ï¼Œå·¥ç¨‹ä¸Šæ™®éé‡‡ç”¨â€œæœ€ç»ˆä¸€è‡´æ€§â€çš„æ€è·¯æ¥æ¢å–é«˜å¯ç”¨ä¸å¯æ‰©å±•ã€‚\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2 id=\"ä¸é›†ä¸­å¼-cs-æ¶æ„å¯¹æ¯”\"\u003eä¸é›†ä¸­å¼ C/S æ¶æ„å¯¹æ¯”\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#ä¸é›†ä¸­å¼-cs-æ¶æ„å¯¹æ¯”\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eé›†ä¸­å¼ï¼ˆå•ä½“ï¼‰C/S æ¶æ„ç¤ºæ„ï¼š\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post/redistributedservicesystem/a98ad925f117.png\" alt=\"Tra-CS-System\"\u003e\u003c/p\u003e\n\u003cp\u003eåˆ†å¸ƒå¼ç³»ç»Ÿå¸¸è§å½¢æ€ï¼š\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post/redistributedservicesystem/29d8d45dfd6d.png\" alt=\"Redi-System\"\u003e\u003c/p\u003e\n\u003ch2 id=\"åˆ†å¸ƒå¼ç³»ç»Ÿä¸ºä»€ä¹ˆéš¾\"\u003eåˆ†å¸ƒå¼ç³»ç»Ÿä¸ºä»€ä¹ˆâ€œéš¾â€\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#åˆ†å¸ƒå¼ç³»ç»Ÿä¸ºä»€ä¹ˆéš¾\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eå•æœºç³»ç»Ÿçš„å‡è®¾åœ¨åˆ†å¸ƒå¼é‡Œå…¨éƒ¨å¤±æ•ˆ ğŸ‘‡\u003c/p\u003e\n\u003ch3 id=\"å•æœºä½ é»˜è®¤è®¤ä¸º\"\u003eå•æœºä½ é»˜è®¤è®¤ä¸ºï¼š\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#å•æœºä½ é»˜è®¤è®¤ä¸º\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eå†…å­˜å¯é \u003c/li\u003e\n\u003cli\u003eæ—¶é’Ÿä¸€è‡´\u003c/li\u003e\n\u003cli\u003eè°ƒç”¨ä¸€å®šæˆåŠŸ\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"åˆ†å¸ƒå¼é‡Œç°å®æ˜¯\"\u003eåˆ†å¸ƒå¼é‡Œç°å®æ˜¯ï¼š\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#åˆ†å¸ƒå¼é‡Œç°å®æ˜¯\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eç½‘ç»œå¯èƒ½æ–­\u003c/li\u003e\n\u003cli\u003eèŠ‚ç‚¹å¯èƒ½æŒ‚\u003c/li\u003e\n\u003cli\u003eæ—¶é’Ÿä¸åŒæ­¥\u003c/li\u003e\n\u003cli\u003eæ¶ˆæ¯å¯èƒ½ä¸¢ / é‡å¤ / å»¶è¿Ÿ\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eğŸ‘‰ \u003cstrong\u003eåˆ†å¸ƒå¼ç³»ç»Ÿ = åœ¨â€œä¸å¯ä¿¡ç¯å¢ƒâ€ä¸‹åšå¯é ç³»ç»Ÿ\u003c/strong\u003e\u003c/p\u003e\n\u003ch2 id=\"åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ ¸å¿ƒé—®é¢˜å¿…é¡»è§£å†³\"\u003eåˆ†å¸ƒå¼ç³»ç»Ÿçš„æ ¸å¿ƒé—®é¢˜ï¼ˆå¿…é¡»è§£å†³ï¼‰\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ ¸å¿ƒé—®é¢˜å¿…é¡»è§£å†³\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003ch3 id=\"1ï¸âƒ£-é€šä¿¡\"\u003e1ï¸âƒ£ é€šä¿¡\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#1ï¸âƒ£-é€šä¿¡\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eèŠ‚ç‚¹ä¹‹é—´æ€ä¹ˆè¯´è¯ï¼Ÿ\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eHTTP / RPC / gRPC\u003c/li\u003e\n\u003cli\u003eæ¶ˆæ¯é˜Ÿåˆ—ï¼ˆKafka / RocketMQ / RabbitMQï¼‰\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch3 id=\"2ï¸âƒ£-çŠ¶æ€ä¸€è‡´æ€§æœ€æ ¸å¿ƒ\"\u003e2ï¸âƒ£ çŠ¶æ€ä¸€è‡´æ€§ï¼ˆæœ€æ ¸å¿ƒï¼‰\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#2ï¸âƒ£-çŠ¶æ€ä¸€è‡´æ€§æœ€æ ¸å¿ƒ\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eå¤šå°æœºå™¨çš„æ•°æ®æ€ä¹ˆä¿æŒä¸€è‡´ï¼Ÿ\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eå¼ºä¸€è‡´ï¼ˆé“¶è¡Œè½¬è´¦ï¼‰\u003c/li\u003e\n\u003cli\u003eæœ€ç»ˆä¸€è‡´ï¼ˆç‚¹èµã€æ¨èï¼‰\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eğŸ‘‰ è¿™ç›´æ¥å¼•å‡º \u003cstrong\u003eCAP å®šç†\u003c/strong\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003ch3 id=\"3ï¸âƒ£-å®¹é”™\"\u003e3ï¸âƒ£ å®¹é”™\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#3ï¸âƒ£-å®¹é”™\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eæŸå°æœºå™¨æŒ‚äº†æ€ä¹ˆåŠï¼Ÿ\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eå‰¯æœ¬ï¼ˆReplicaï¼‰\u003c/li\u003e\n\u003cli\u003eè‡ªåŠ¨åˆ‡æ¢ï¼ˆFailoverï¼‰\u003c/li\u003e\n\u003cli\u003eé‡è¯• / è¶…æ—¶\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch3 id=\"4ï¸âƒ£-æ‰©å±•æ€§\"\u003e4ï¸âƒ£ æ‰©å±•æ€§\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#4ï¸âƒ£-æ‰©å±•æ€§\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eè®¿é—®é‡ç¿» 10 å€æ€ä¹ˆåŠï¼Ÿ\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eåŠ æœºå™¨ï¼ˆHorizontal Scalingï¼‰\u003c/li\u003e\n\u003cli\u003eè´Ÿè½½å‡è¡¡ï¼ˆLoad Balancerï¼‰\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003ch2 id=\"cap-å®šç†åˆ†å¸ƒå¼çš„ç‰©ç†å®šå¾‹\"\u003eCAP å®šç†ï¼ˆåˆ†å¸ƒå¼çš„â€œç‰©ç†å®šå¾‹â€ï¼‰\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#cap-å®šç†åˆ†å¸ƒå¼çš„ç‰©ç†å®šå¾‹\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eåœ¨å‡ºç°ç½‘ç»œåˆ†åŒºï¼ˆPï¼‰æ—¶ï¼Œ\u003cstrong\u003eC å’Œ A åªèƒ½é€‰ä¸€ä¸ª\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCï¼ˆConsistencyï¼‰\u003c/strong\u003eï¼šä¸€è‡´æ€§\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAï¼ˆAvailabilityï¼‰\u003c/strong\u003eï¼šå¯ç”¨æ€§\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ePï¼ˆPartition toleranceï¼‰\u003c/strong\u003eï¼šåˆ†åŒºå®¹é”™ï¼ˆå¿…é¡»è¦ï¼‰\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eç°å®ç³»ç»Ÿï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eé‡‘èç³»ç»Ÿ\u003c/strong\u003e â†’ CP\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eç¤¾äº¤/æ¨è\u003c/strong\u003e â†’ AP\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/blockquote\u003e\n\u003ch1 id=\"è®¾è®¡æ€è·¯æ€»è§ˆ\"\u003eè®¾è®¡æ€è·¯æ€»è§ˆ\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#è®¾è®¡æ€è·¯æ€»è§ˆ\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eæ¶ˆæ¯é©±åŠ¨ï¼šç”¨æ¶ˆæ¯ä½œä¸ºæœåŠ¡é—´åä½œçš„â€œç¬¬ä¸€å…¬æ°‘â€ï¼Œå¤©ç„¶è§£è€¦ï¼Œæ˜“æ‰©å±•ã€‚\u003c/li\u003e\n\u003cli\u003eActor æ¨¡å‹ï¼šæŠŠæœåŠ¡å®ä¾‹æŠ½è±¡æˆ Actorï¼Œå¤„ç†æ¶ˆæ¯ã€ç»´æŠ¤è‡ªèº«çŠ¶æ€ï¼Œéš”ç¦»å¹¶å‘ã€‚\u003c/li\u003e\n\u003cli\u003eMongoDB/Postgresï¼šæ¨¡å‹é€‚é…ä¸šåŠ¡å¯¹è±¡ï¼Œæ”¯æŒåˆ†ç‰‡ä¸åˆ†åŒºæˆ–åˆ†é›†ï¼Œåˆ©äºæ‰©å±•ä¸æé«˜é«˜å¯ç”¨ã€‚\u003c/li\u003e\n\u003cli\u003eRedisï¼šä½œä¸ºè¯»å†™çƒ­ç‚¹çš„é«˜é€Ÿç¼“å­˜ï¼Œä¹Ÿå¯æ‰¿æ‹…é™æµã€çŸ­æœŸé˜Ÿåˆ—ç­‰è§’è‰²ã€‚\u003c/li\u003e\n\u003cli\u003eKafka/RocketMQ: ä½œä¸ºç”Ÿäº§è€…/æ¶ˆè´¹è€…çš„æ¶ˆæ¯é€šé“ã€‚\u003c/li\u003e\n\u003cli\u003eå·¥ç¨‹åŸåˆ™ï¼šè¾¹ç•Œæ¸…æ™°ã€å•ä¸€èŒè´£ã€å¹‚ç­‰ä¸é‡è¯•ã€å°½é‡æ— çŠ¶æ€ï¼ˆå°¤å…¶æ˜¯ç½‘å…³å±‚ï¼‰ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"actor-æ¨¡å‹\"\u003eActor æ¨¡å‹\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#actor-æ¨¡å‹\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eActorçš„ç†è®ºæ€§å¯¹åº”åˆ°å®é™…å·¥ç¨‹åœºæ™¯å…¶å®å°±æ˜¯å…·å¤‡è‡ªæœ‰çŠ¶æ€çš„å¾®æœåŠ¡å­æ¨¡å—ã€‚\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eå‚è€ƒç»´åŸºç™¾ç§‘ï¼š\u003ca href=\"https://en.wikipedia.org/wiki/Actor_model\"\u003eActor Model\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eActor æ˜¯ä¸€ä¸ªåŸºæœ¬çš„è®¡ç®—å•å…ƒï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eæ¥æ”¶æ¶ˆæ¯ï¼ˆMailboxï¼‰ã€‚\u003c/li\u003e\n\u003cli\u003eåŸºäºå½“å‰çŠ¶æ€ä¸è¡Œä¸ºå¤„ç†æ¶ˆæ¯ï¼ˆBehavior + Stateï¼‰ã€‚\u003c/li\u003e\n\u003cli\u003eäº§ç”Ÿæ–°çš„çŠ¶æ€ä¸å¯é€‰çš„å“åº”æ¶ˆæ¯ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eActor ä¹‹é—´å½¼æ­¤éš”ç¦»ï¼Œä¸å…±äº«å†…å­˜ï¼Œé æ¶ˆæ¯é€šä¿¡å®Œæˆåä½œã€‚è¿™ç§æ¨¡å‹ç‰¹åˆ«é€‚åˆé«˜å¹¶å‘ã€å¼ºéš”ç¦»çš„åˆ†å¸ƒå¼åœºæ™¯ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/post/redistributedservicesystem/1104498e5f0a.png\" alt=\"Actor Model\"\u003e\u003c/p\u003e\n\u003cp\u003eåœ¨ç³»ç»Ÿåˆ†å±‚ä¸­ï¼Œå¯ä»¥æŠŠâ€œæœåŠ¡ Nâ€æŠ½è±¡ä¸ºä¸€ç»„ Actorï¼šæ¯ä¸ªæœåŠ¡è¢«æ‹†åˆ†ä¸ºè‹¥å¹²èŒè´£å•ä¸€çš„ Actorï¼Œåˆ†åˆ«è´Ÿè´£ä¼šè¯ã€è®¢å•ã€åº“å­˜ã€ç»“ç®—ç­‰å­åŸŸé€»è¾‘ã€‚è¿™æ ·æ—¢é™ä½äº†è€¦åˆï¼Œä¹Ÿåˆ©äºä¼¸ç¼©ã€‚\u003c/p\u003e\n\u003ch3 id=\"çŠ¶æ€æœºfsmä¸-actor\"\u003eçŠ¶æ€æœºï¼ˆFSMï¼‰ä¸ Actor\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#çŠ¶æ€æœºfsmä¸-actor\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eå¾ˆå¤š Actor å†…éƒ¨å¯ç”¨æœ‰é™çŠ¶æ€æœºï¼ˆFSMï¼‰æ¥ç»„ç»‡é€»è¾‘ã€‚FSM çš„å››è¦ç´ ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eçŠ¶æ€ï¼ˆStateï¼‰\u003c/li\u003e\n\u003cli\u003eäº‹ä»¶ï¼ˆEventï¼‰\u003c/li\u003e\n\u003cli\u003eåŠ¨ä½œï¼ˆActionï¼‰\u003c/li\u003e\n\u003cli\u003eå˜æ¢ï¼ˆTransitionï¼‰\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eçŠ¶æ€æœºä»â€œå¼€å§‹æ€â€å‡ºå‘ï¼Œåœ¨äº‹ä»¶è§¦å‘ä¸‹è¿ç§»åˆ°ä¸‹ä¸€çŠ¶æ€å¹¶æ‰§è¡Œç›¸åº”åŠ¨ä½œï¼Œæœ€ç»ˆåˆ°è¾¾â€œç»“æŸæ€â€ã€‚æŠŠçŠ¶æ€æœºè§†ä¸ºä¸€ä¸ªâ€œé»‘ç›’â€ï¼Œå¯¹å¤–åªæš´éœ²äº‹ä»¶ä¸ç»“æœï¼Œå¯ä»¥å¾ˆå¥½åœ°å®ç°å†…éƒ¨ä¿¡æ¯éš”ç¦»ä¸çŠ¶æ€å®‰å…¨ã€‚\u003c/p\u003e\n\u003chr\u003e\n\u003ch2 id=\"æ•°æ®å±‚mongodbpostgres\"\u003eæ•°æ®å±‚ï¼šMongoDB/Postgres\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#æ•°æ®å±‚mongodbpostgres\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eMongoDB éå¸¸å¥‘åˆåˆ†å¸ƒå¼ç³»ç»Ÿï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eæ•°æ®æ¨¡å‹ï¼ˆDocument/Collection/Tableï¼‰æ¥è¿‘ä¸šåŠ¡\u003cstrong\u003eå¯¹è±¡ç»“æ„\u003c/strong\u003eï¼Œè¯»å†™è‡ªç„¶ã€‚\u003c/li\u003e\n\u003cli\u003eåˆ†ç‰‡ï¼ˆShardingï¼‰ä¸ºæ°´å¹³æ‰©å±•è€Œç”Ÿï¼Œå¯æŠŠæ•°æ®æŒ‰é”®å‡è¡¡åˆ†å¸ƒåˆ°å¤šèŠ‚ç‚¹ã€‚\u003c/li\u003e\n\u003cli\u003eå‰¯æœ¬é›†ï¼ˆReplica Setï¼‰æä¾›é«˜å¯ç”¨ä¸è¯»å†™åˆ†ç¦»ç­–ç•¥ã€‚\u003c/li\u003e\n\u003cli\u003eä¸€è‡´æ€§ä¸äº‹åŠ¡ï¼šæ”¯æŒå¤šæ–‡æ¡£äº‹åŠ¡ï¼Œä½†å·¥ç¨‹ä¸Šå¸¸ä»¥â€œæœ€ç»ˆä¸€è‡´æ€§ + å¹‚ç­‰è¡¥å¿â€é™ä½è€¦åˆä¸å¼€é”€ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"/post/redistributedservicesystem/7ea8177a86d6.png\" alt=\"mongo-db\"\u003e\u003c/p\u003e\n\u003cp\u003eå·¥ç¨‹å®è·µä¸­çš„å»ºè®®ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eè®¾è®¡å¥½åˆ†ç‰‡é”®ï¼ˆé«˜åŸºæ•°ã€å†™å…¥å‡åŒ€ã€æŸ¥è¯¢å‘½ä¸­é«˜ï¼‰ã€‚\u003c/li\u003e\n\u003cli\u003eç»“åˆå‰¯æœ¬é›†èŠ‚ç‚¹è§’è‰²åšè¯»å†™ç­–ç•¥ï¼ˆprimary writeï¼Œsecondary readï¼‰ã€‚\u003c/li\u003e\n\u003cli\u003eç”¨åˆç†çš„ç´¢å¼•ä¸ TTL ç´¢å¼•ç®¡ç†çƒ­æ•°æ®ä¸å†å²æ•°æ®ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003eè¦ç”¨å¥½ORMï¼Œåœ¨Goè¯­è¨€ä¸­æœ‰ä¸ªgormå¾ˆå—æ¬¢è¿ã€‚\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2 id=\"ç¼“å­˜å±‚redis\"\u003eç¼“å­˜å±‚ï¼šRedis\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#ç¼“å­˜å±‚redis\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eRedis åœ¨è¯¥ä½“ç³»ä¸­çš„å®šä½ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eçƒ­ç‚¹æ•°æ®ç¼“å­˜ï¼šé™ä½æ•°æ®åº“å‹åŠ›ï¼Œæå‡è¯»æ€§èƒ½ï¼ˆå¯ç”¨ Cache-Aside/Read-Through/Write-Through ç­‰ç­–ç•¥ï¼‰ã€‚\u003c/li\u003e\n\u003cli\u003eçŸ­æœŸé˜Ÿåˆ—ä¸é™æµï¼šåŸºäº List/Stream/ä»¤ç‰Œæ¡¶å®ç°ç®€å•é˜Ÿåˆ—ä¸é™æµã€‚\u003c/li\u003e\n\u003cli\u003eä¼šè¯ä¸ä¸´æ—¶æ€ï¼šå­˜å‚¨çŸ­æœŸä¼šè¯ã€å¹‚ç­‰ä»¤ç‰Œã€åˆ†å¸ƒå¼é”ç­‰ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"/post/redistributedservicesystem/b23b8e305828.png\" alt=\"redis\"\u003e\u003c/p\u003e\n\u003cp\u003eæ³¨æ„å…¸å‹é£é™©ä¸å¯¹ç­–ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eç¼“å­˜ç©¿é€ï¼šä¸ºä¸å­˜åœ¨çš„é”®å¢åŠ ç©ºå€¼ç¼“å­˜ + å¸ƒéš†è¿‡æ»¤å™¨ã€‚\u003c/li\u003e\n\u003cli\u003eç¼“å­˜å‡»ç©¿ï¼šå¯¹çƒ­ç‚¹ Key å¢åŠ äº’æ–¥æ›´æ–°æˆ–ä½¿ç”¨é€»è¾‘è¿‡æœŸ + åå°åˆ·æ–°ã€‚\u003c/li\u003e\n\u003cli\u003eç¼“å­˜é›ªå´©ï¼šè¿‡æœŸæ—¶é—´éšæœºåŒ–ï¼Œè®¾ç½®å¤šçº§é™æµä¸é™çº§ç­–ç•¥ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"æœåŠ¡å‘ç°ä¸é…ç½®etcd\"\u003eæœåŠ¡å‘ç°ä¸é…ç½®ï¼šetcd\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#æœåŠ¡å‘ç°ä¸é…ç½®etcd\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eetcd æ˜¯ä¸€ä¸ªåŸºäº Raft å…±è¯†ç®—æ³•çš„åˆ†å¸ƒå¼é”®å€¼å­˜å‚¨ï¼Œå¸¸ç”¨äºæœåŠ¡æ³¨å†Œä¸å‘ç°ã€åŠ¨æ€é…ç½®ä¸åˆ†å¸ƒå¼åè°ƒï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eæœåŠ¡æ³¨å†Œä¸å‘ç°ï¼š\n\u003cul\u003e\n\u003cli\u003eæ³¨å†Œï¼šå®ä¾‹ä»¥ç§Ÿçº¦ï¼ˆLease + TTLï¼‰çš„æ–¹å¼åœ¨ \u003ccode\u003e/services/{name}/{instanceId}\u003c/code\u003e ä¸‹å†™å…¥è‡ªèº«åœ°å€ä¸å…ƒä¿¡æ¯ï¼Œå¹¶å®šæœŸ KeepAliveã€‚\u003c/li\u003e\n\u003cli\u003eå‘ç°ï¼šç½‘å…³æˆ–è°ƒç”¨æ–¹ Watch å¯¹åº”å‰ç¼€å˜åŒ–ï¼Œæ„ŸçŸ¥å®ä¾‹ä¸Šä¸‹çº¿å¹¶æ›´æ–°æœ¬åœ°è·¯ç”±ã€‚\u003c/li\u003e\n\u003cli\u003eå¥å£®æ€§ï¼šç§Ÿçº¦åˆ°æœŸè‡ªåŠ¨åˆ é™¤é”®ï¼Œé¿å…â€œåƒµå°¸å®ä¾‹â€ï¼›å®¢æˆ·ç«¯åº”å®ç°æŒ‡æ•°é€€é¿ä¸æŠ–åŠ¨é‡è¿ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eåŠ¨æ€é…ç½®ï¼š\n\u003cul\u003e\n\u003cli\u003eå°†é…ç½®ç»„ç»‡åœ¨ \u003ccode\u003e/config/{app}/{env}/\u003c/code\u003e å‰ç¼€ä¸‹ï¼Œå‘å¸ƒæ–¹å†™å…¥ï¼Œå®¢æˆ·ç«¯ Watch å¹¶çƒ­æ›´æ–°ã€‚\u003c/li\u003e\n\u003cli\u003eå¤§ä½“é‡é…ç½®å»ºè®®æ‹†åˆ†æ¨¡å—/åˆ†æ®µåŠ è½½ï¼›æ•æ„Ÿé…ç½®éœ€é…åˆåŠ å¯†æˆ–ä¸“ç”¨é…ç½®ä¸­å¿ƒã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eåè°ƒèƒ½åŠ›ï¼š\n\u003cul\u003e\n\u003cli\u003eåˆ†å¸ƒå¼é”/Leader é€‰ä¸¾ï¼šä½¿ç”¨ etcd concurrency APIï¼ˆåŸºäºä¼šè¯çš„ Mutex/Campaignï¼‰ã€‚\u003c/li\u003e\n\u003cli\u003eå…¸å‹ç”¨é€”ï¼šä»»åŠ¡åˆ†ç‰‡è°ƒåº¦ã€å•ä¸»å†™å…¥ã€é™æµé…é¢çš„é›†ä¸­ä»²è£ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eè¿ç»´è¦ç‚¹ï¼š\n\u003cul\u003e\n\u003cli\u003eé›†ç¾¤è§„æ¨¡ä»¥ 3 æˆ– 5 èŠ‚ç‚¹ä¸ºå®œï¼ˆå¥‡æ•°æŠ•ç¥¨ï¼Œè¿‡å¤§åè€Œé™ä½å†™æ€§èƒ½ï¼‰ã€‚\u003c/li\u003e\n\u003cli\u003eåˆç†è®¾ç½®å¿«ç…§ä¸å‹ç¼©ï¼ˆCompactionï¼‰ï¼Œé¿å… Watch Backlog è¿‡å¤§ï¼›å¯¹é«˜å»¶è¿Ÿé“¾è·¯è®¾ç½®è¶…æ—¶ä¸å¿ƒè·³é˜ˆå€¼ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eåœ¨æœ¬æ–‡æ¶æ„ä¸­ï¼Œetcd æ‰¿æ‹…â€œæœåŠ¡æ³¨å†Œä¸å‘ç° + åŠ¨æ€é…ç½® + åè°ƒåŸè¯­â€çš„åŸºç¡€è®¾æ–½è§’è‰²ï¼Œè¾…åŠ©ç½‘å…³è·¯ç”±ä¸å†…éƒ¨æœåŠ¡å¯»å€ã€‚\u003c/p\u003e\n\u003chr\u003e\n\u003ch2 id=\"é€šä¿¡ä¸ä¸€è‡´æ€§ç­–ç•¥\"\u003eé€šä¿¡ä¸ä¸€è‡´æ€§ç­–ç•¥\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#é€šä¿¡ä¸ä¸€è‡´æ€§ç­–ç•¥\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eé€šä¿¡æ–¹å¼ï¼š\n- åŒæ­¥ RPCï¼ˆHTTP/gRPCï¼‰ç”¨äºå¼ºå®æ—¶ã€å¼ºä¸€è‡´çš„å°é—­ç¯ã€‚\n- å¼‚æ­¥æ¶ˆæ¯æ€»çº¿ç”¨äºè§£è€¦ä¸å‰Šå³°å¡«è°·ï¼ˆRocketMQ/Kafka/RabbitMQ/Redis Stream ç­‰ï¼‰ã€‚\u003c/li\u003e\n\u003cli\u003eé‡è¯•ä¸å¹‚ç­‰ï¼š\n\u003cul\u003e\n\u003cli\u003eä¸‹æ¸¸çŸ­æš‚ä¸å¯ç”¨æ—¶å¯é‡è¯•ï¼›æ‰€æœ‰å¯é‡è¯•çš„å†™æ“ä½œå¿…é¡»å¹‚ç­‰ï¼ˆå»é‡é”®ã€å¹‚ç­‰ä»¤ç‰Œï¼‰ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eæœ€ç»ˆä¸€è‡´æ€§ï¼š\n\u003cul\u003e\n\u003cli\u003eSaga/Outbox Patternï¼šç”¨æœ¬åœ°äº‹åŠ¡ + äº‹ä»¶å¤–å‘ä¿è¯å˜æ›´å¯è¾¾ï¼Œå¤±è´¥åˆ™ç¼–æ’è¡¥å¿ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eå…¨å±€æ ‡è¯†ï¼š\n\u003cul\u003e\n\u003cli\u003eé›ªèŠ±ç®—æ³•/å·æ®µç¼“å­˜ç”Ÿæˆå¯æ’åºçš„åˆ†å¸ƒå¼ IDï¼Œä¾¿äºè·¯ç”±ä¸å®¡è®¡ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"æ¶ˆæ¯ä¸­é—´ä»¶rocketmqkafka\"\u003eæ¶ˆæ¯ä¸­é—´ä»¶ï¼šRocketMQ/Kafka\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#æ¶ˆæ¯ä¸­é—´ä»¶rocketmqkafka\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eRocketMQ/Kafkaè¿™ç±»æ˜¯é«˜æ€§èƒ½ã€ä½å»¶è¿Ÿçš„åˆ†å¸ƒå¼æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œå…·æœ‰å®Œå¤‡çš„æ¶ˆæ¯è¯­ä¹‰ä¸ä¼ä¸šçº§ç‰¹æ€§ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eæ ¸å¿ƒæ¦‚å¿µï¼šTopicã€Tagã€Message Keyã€Producer Groupã€Consumer Groupã€‚\u003c/li\u003e\n\u003cli\u003eæŠ•é€’è¯­ä¹‰ï¼šé»˜è®¤è‡³å°‘ä¸€æ¬¡ï¼ˆAt-Least-Onceï¼‰ï¼Œç²¾ç¡®ä¸€æ¬¡éœ€åœ¨ä¸šåŠ¡å±‚é€šè¿‡å¹‚ç­‰é”®/å»é‡è¡¨å®ç°ã€‚\u003c/li\u003e\n\u003cli\u003eé¡ºåºæ¶ˆæ¯ï¼šåŸºäºåˆ†ç‰‡é”®ï¼ˆSharding Keyï¼‰åœ¨é˜Ÿåˆ—å†…ä¿è¯å±€éƒ¨æœ‰åºï¼Œé€‚ç”¨äºè®¢å•çŠ¶æ€æµã€èµ„é‡‘æµæ°´ç­‰åœºæ™¯ã€‚\u003c/li\u003e\n\u003cli\u003eäº‹åŠ¡æ¶ˆæ¯ï¼š\n\u003cul\u003e\n\u003cli\u003eæµç¨‹ï¼šå‘é€åŠæ¶ˆæ¯ï¼ˆPrepareï¼‰â†’ æ‰§è¡Œæœ¬åœ°äº‹åŠ¡ â†’ Commit/Rollbackï¼›\u003c/li\u003e\n\u003cli\u003eBroker å¯å›æŸ¥äº‹åŠ¡çŠ¶æ€ï¼ˆTransaction Checkï¼‰ä»¥é˜²æ‚¬æŒ‚ï¼Œç”Ÿäº§è€…éœ€å®ç°å›æŸ¥æ¥å£ï¼›\u003c/li\u003e\n\u003cli\u003eå¸¸ç”¨äº Saga/Outbox çš„å¯é äº‹ä»¶å¤–å‘ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eå»¶è¿Ÿ/å®šæ—¶æ¶ˆæ¯ï¼šå†…å»ºå¤šçº§å»¶è¿Ÿï¼›é…åˆé‡è¯•ç­–ç•¥å®ç°æŸ”æ€§äº‹åŠ¡ä¸å‰Šå³°ã€‚\u003c/li\u003e\n\u003cli\u003eé‡è¯•ä¸æ­»ä¿¡ï¼š\n\u003cul\u003e\n\u003cli\u003eæ¶ˆè´¹å¤±è´¥æŒ‰é‡è¯•ç­–ç•¥å›æŠ•ï¼Œè¶…è¿‡é˜ˆå€¼è¿›å…¥ DLQï¼ˆæ­»ä¿¡é˜Ÿåˆ—ï¼‰ï¼Œä¾¿äºæ’æŸ¥ä¸äººå·¥è¡¥å¿ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eæ¶ˆè´¹æ¨¡å¼ï¼šé›†ç¾¤ï¼ˆè´Ÿè½½å‡è¡¡ï¼‰ä¸å¹¿æ’­ï¼ˆå…¨éƒ¨æ¶ˆè´¹ï¼‰ï¼›é€šå¸¸ä¸šåŠ¡æ¶ˆè´¹é‡‡ç”¨é›†ç¾¤æ¨¡å¼ã€‚\u003c/li\u003e\n\u003cli\u003eè®¾è®¡å»ºè®®ï¼š\n\u003cul\u003e\n\u003cli\u003eæ¶ˆæ¯å¹‚ç­‰ï¼šä½¿ç”¨ä¸šåŠ¡å”¯ä¸€é”®ï¼ˆå¦‚è®¢å•å·ï¼‰å»é‡ï¼›æ¶ˆè´¹è€…ä¾§â€œå…ˆåˆ¤é‡åæ‰§è¡Œâ€ã€‚\u003c/li\u003e\n\u003cli\u003eè´Ÿè½½ä¸æ‰©å±•ï¼šæŒ‰ååä¸æœ‰åºéœ€æ±‚è§„åˆ’é˜Ÿåˆ—æ•°ï¼›é¿å…æ¶ˆæ¯ä½“è¿‡å¤§ï¼ˆå»ºè®® \u0026#x3C; 1MBï¼‰ï¼Œå¤§å¯¹è±¡èµ°å­˜å‚¨ï¼Œæ¶ˆæ¯åªæ”¾å¼•ç”¨ã€‚\u003c/li\u003e\n\u003cli\u003eå¯è§‚æµ‹ï¼šå¼€å¯æ¶ˆæ¯è½¨è¿¹ä¸æŒ‡æ ‡ä¸ŠæŠ¥ï¼Œå…³æ³¨å †ç§¯ã€è€—æ—¶ä¸å›æŸ¥æ¯”ä¾‹ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eåœ¨æ¶æ„ä¸­ï¼ŒRocketMQ/Kafka ä½œä¸ºâ€œäº‹ä»¶æ€»çº¿â€ï¼Œæ”¯æ’‘è·¨æœåŠ¡è§£è€¦ã€å‰Šå³°å¡«è°·ä¸æœ€ç»ˆä¸€è‡´æ€§ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eOutboxï¼šä¸šåŠ¡è¡¨ + outbox è¡¨æœ¬åœ°äº‹åŠ¡æäº¤ï¼Œåå°å‘å¸ƒåˆ° RocketMQï¼Œæ¶ˆè´¹ä¾§å¹‚ç­‰å…¥åº“ã€‚\u003c/li\u003e\n\u003cli\u003eSagaï¼šç¼–æ’å™¨åŸºäºäº‹ä»¶æ¨è¿›/å›æ»šæ­¥éª¤ï¼Œå¤±è´¥èµ°è¡¥å¿æ¶ˆæ¯ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"æ‹“æ‰‘ä¸éƒ¨ç½²\"\u003eæ‹“æ‰‘ä¸éƒ¨ç½²\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#æ‹“æ‰‘ä¸éƒ¨ç½²\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eå…¸å‹æ‹“æ‰‘ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eç½‘å…³ï¼ˆGatewayï¼‰ï¼šå¯¹å¤–å”¯ä¸€å…¥å£ï¼Œåšé‰´æƒã€è·¯ç”±ã€é™æµä¸èšåˆã€‚\u003c/li\u003e\n\u003cli\u003eæœåŠ¡æ³¨å†Œä¸å‘ç°ï¼šåŸºäº etcd çš„æ³¨å†Œè¡¨ä¸ Watchï¼Œå®ç°åŠ¨æ€å¯»å€ä¸å¥åº·æ£€æŸ¥ï¼ˆä¹Ÿå¯é…åˆ Sidecarï¼‰ã€‚\u003c/li\u003e\n\u003cli\u003eå†…éƒ¨æœåŠ¡ï¼šæŒ‰åŸŸåˆ’åˆ†çš„å¾®æœåŠ¡/Actor ç¾¤ç»„ï¼Œäº’ç›¸é€šè¿‡ RPC/æ¶ˆæ¯äº¤äº’ã€‚\u003c/li\u003e\n\u003cli\u003eæ•°æ®ä¸ç¼“å­˜å±‚ï¼šMongoDB é›†ç¾¤ + Redis é›†ç¾¤ï¼Œç»“åˆå‰¯æœ¬é›†ã€å“¨å…µä¸åˆ†ç‰‡è®¾è®¡ã€‚\u003c/li\u003e\n\u003cli\u003eæ¶ˆæ¯å±‚ï¼šRocketMQ Broker é›†ç¾¤ + NameServerï¼ŒæŒ‰ Topic/é˜Ÿåˆ—æ‰©å±•ååã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"/post/redistributedservicesystem/a5b1f3959027.png\" alt=\"diagram\"\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003ch2 id=\"é€‚ç”¨åœºæ™¯\"\u003eé€‚ç”¨åœºæ™¯\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#é€‚ç”¨åœºæ™¯\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eå¤§é‡å¹¶å‘æ¥å…¥ï¼ˆæµ·é‡ç”¨æˆ·ã€IoT è®¾å¤‡ã€æ¸¸æˆç½‘å…³ç­‰ï¼‰ã€‚\u003c/li\u003e\n\u003cli\u003eæ•°æ®è§„æ¨¡åºå¤§ï¼Œéœ€è¦æ°´å¹³æ‰©å®¹ä¸å¼¹æ€§ï¼ˆæ—¥å¿—/è®¢å•/å†…å®¹å¹³å°ç­‰ï¼‰ã€‚\u003c/li\u003e\n\u003cli\u003eå¯¹é«˜å¯ç”¨æœ‰ç¡¬æ€§è¦æ±‚ï¼ˆé‡‘èæ”¯ä»˜éƒ¨åˆ†ç¯èŠ‚ã€æ ¸å¿ƒäº¤æ˜“è¯»è·¯å¾„ç­‰ï¼‰ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"å°ç»“\"\u003eå°ç»“\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#å°ç»“\"\u003e\u003cspan class=\"anchor-link\"\u003e #\u003c/span\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eè¿™å¥—â€œæ¶ˆæ¯é©±åŠ¨ + Actor + MongoDB/Redisâ€çš„ç»„åˆï¼Œå·¥ç¨‹è·¯å¾„æ¸…æ™°ã€ç”Ÿæ€æˆç†Ÿï¼šå½“æ€§èƒ½ä¸å¤Ÿæ—¶é€šè¿‡å¢åŠ èŠ‚ç‚¹æ‰©å®¹ï¼›å½“æ•°æ®å¢å¤§æ—¶é€šè¿‡ MongoDB åˆ†ç‰‡æ‰©å±•ï¼›å½“è¯»å†™å‹åŠ›ä¸å‡æ—¶å€ŸåŠ© Redis ç¼“å­˜ä¸é™æµå‰Šå³°ã€‚çœŸæ­£çš„éš¾ç‚¹ä¸åœ¨â€œèƒ½å¦å·¥ä½œâ€ï¼Œè€Œåœ¨â€œèƒ½å¦ä¼˜é›…åœ°æ‰©å±•ä¸è¿ç»´â€ã€‚\u003c/p\u003e\n\u003cp\u003eä¸‹ä¸€æ­¥ï¼Œæˆ‘ä¼šåœ¨åç»­åšæ–‡ä¸­ç»“åˆå…·ä½“çš„è®¾è®¡å·¥å…·ä¸ä»£ç ï¼Œæ­å»ºä¸€ä¸ªâ€œå¾®å‹åˆ†å¸ƒå¼æœåŠ¡ç³»ç»Ÿâ€çš„ç«¯åˆ°ç«¯æ ·ä¾‹ï¼Œè¦†ç›–æœåŠ¡æ‹†åˆ†ã€é€šä¿¡ã€ç¼“å­˜ã€ä¸€è‡´æ€§ä¸è§‚æµ‹çš„æœ€å°é—­ç¯ã€‚\u003c/p\u003e"])</script><script>self.__next_f.push([1,"7:[\"$\",\"$L15\",null,{\"postData\":{\"id\":\"redistributedservicesystem\",\"contentHtml\":\"$16\",\"title\":\"åˆ†å¸ƒå¼æœåŠ¡ç³»ç»Ÿè®¾è®¡æ¦‚è¿°\",\"date\":\"$D2020-12-20T10:05:12.000Z\",\"updated\":\"$D2025-08-10T19:10:00.000Z\",\"categories\":[\"éšç¬”\"],\"tags\":[\"SQL\",\"Actor\",\"MongoDB\",\"Redis\",\"etcd\",\"RocketMQ\"]}}]\n"])</script><script>self.__next_f.push([1,"10:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\nb:null\n"])</script><script>self.__next_f.push([1,"14:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"åˆ†å¸ƒå¼æœåŠ¡ç³»ç»Ÿè®¾è®¡æ¦‚è¿°\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"HCHEN90 åšå®¢\"}],[\"$\",\"link\",\"2\",{\"rel\":\"alternate\",\"type\":\"application/atom+xml\",\"href\":\"https://hchen90.top/atom.xml\"}],[\"$\",\"link\",\"3\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"16x16\"}]],\"error\":null,\"digest\":\"$undefined\"}\ne:{\"metadata\":\"$14:metadata\",\"error\":null,\"digest\":\"$undefined\"}\n"])</script></body></html>