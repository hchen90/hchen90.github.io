{"code":0,"data":{"title":"如何在Visual Studio 2010中使用SQL Server 2008","content":"# 如何在Visual Studio 2010中使用SQL Server 2008\n\nSQL Server是微软的数据库产品，也是一个较为众所周知的数据库产品，其中SQL Server 2000深受广大的用户的青睐，知名度较高，SQL Server 2008是其的后继产品之一，废话不多说了（本文不讨论VS或SQL Server的安装，假设预制环境就绪）。\n\n首先在菜单的`视图`->`其他窗口`->`服务器资源管理器`，打开一个小的浮动窗口，就像这个样：\n\n![pic1](/post/vssqlserver2008/524a2775c659.png)\n\n可以在`数据连接`项，右击，`创建新SQL Server数据库`，出现以下这个对话框：\n\n![pic2](/post/vssqlserver2008/0493365c3b52.png)\n\n点击一下`刷新`，在左边的输入控件的下拉菜单可以选择一个服务器，如果没有，说明本地的服务段（假设你的计算机处于脱机状态）未启动，通常像这种庞大的，高稳定的数据库都是一个服务端负责监听，并且在内部完成数据库的数据改动，相当于将数据库的逻辑模式和内部模式放到了服务器端（就像一个Apache服务器，在服务端工作一样）。\n\n如果服务器没有启动，则要启动服务，这个跟mysql在Linux系统中用`service mysqld start`是一样的性质，在windows的开始菜单找到`服务`（Win7在`管理员工具`下面），或者在命令行输入`services.msc`，在`服务`工具的窗口中找到`SQL Server （SQLEXPRESS）`，\n\n`SQL Server Browser`和`SQL Server VSS Writer`，将这些服务启动，再回到上面的对话框，点击`刷新`，再单击下拉菜单应该就可看到服务器名了，说明服务器端已经启动，可以连接了。\n\n在上面的服务器端选择后，输入新的数据库名，点击`确定`，就完成一个数据库的创建。 数据库创建后，就来连接刚才创建的数据。\n\n依然在`数据连接`项上，右击，`添加连接`，会出现一个`选择数据源`的对话框：\n\n![pic3](/post/vssqlserver2008/0f72499c920a.png)\n\n这里选择`Microsoft SQL Server`，单击`继续`，之后出现一个`添加连接`的对话框：\n\n![pic4](/post/vssqlserver2008/ae0268d55a7b.png)\n\n服务器名就是刚才启动服务后添加的服务器名，点击下拉菜单可以看到，数据名项就输入刚才创建的那个数据库，也可以点击下拉菜单来选择自己的数据库，在未确定前也可以单击`测试连接`来验证一下，而后单击`确定`。\n\n其实也可以在上面的`添加连接`，选择数据库名前不用创建一个新的数据库也可以，在`添加连接`对话框中的数据库名项，随便选个其他的数据库，登陆到数据库系统中，当登陆成功后，在查询栏中输入`create database XXX;`也可以创建数据库，其中XXX是数据库的名称，当要删除/摧毁这个数据库时，用`drop database XXX;`即可删掉XXX数据库。\n\n在`服务器资源管理器`可以看到新建的数据库已经添加到`数据连接`的下面：\n\n![pic5](/post/vssqlserver2008/26d073fc8ae4.png)\n\n在`数据资源管理器`中的`数据连接`的下面，右击刚才的数据库，出现的菜单里有很多内容，选择`新建查询`，即可用SQL语言对数据库进行操作了。\n\n要关闭数据库连接时，同样右击数据库名，单击`关闭连接`即可。\n"}}